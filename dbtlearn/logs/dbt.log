

============================== 2023-01-31 17:58:30.530815 | 6022f98c-dda0-406e-b544-3fe4f0d5220d ==============================
[0m17:58:30.530815 [info ] [MainThread]: Running with dbt=1.4.1
[0m17:58:30.534082 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:58:30.534792 [debug] [MainThread]: Tracking: tracking
[0m17:58:30.574267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8773e5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8773e5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8773e5e80>]}
[0m17:58:31.468925 [debug] [MainThread]: Executing "git --help"
[0m17:58:31.566309 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:58:31.568866 [debug] [MainThread]: STDERR: "b''"
[0m17:58:31.601826 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:58:31.609350 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:58:31.609978 [debug] [MainThread]: On debug: select 1 as id
[0m17:58:31.610574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:34.259622 [debug] [MainThread]: SQL status: SUCCESS 1 in 3 seconds
[0m17:58:34.261986 [debug] [MainThread]: On debug: Close
[0m17:58:34.523703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe878330280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8780384f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe878038ca0>]}
[0m17:58:34.524341 [debug] [MainThread]: Flushing usage events
[0m17:58:34.925561 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-01-31 22:13:20.475061 | baab89fa-57f7-4e2f-a100-ccfcac2b5c3e ==============================
[0m22:13:20.475061 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:13:20.485205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:13:20.486010 [debug] [MainThread]: Tracking: tracking
[0m22:13:20.487452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ae9bd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ae9bddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ae9bdd00>]}
[0m22:13:20.615651 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m22:13:20.616276 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/src/src_listings.sql
[0m22:13:20.616663 [debug] [MainThread]: Partial parsing: deleted file: dbtlearn://models/example/my_first_dbt_model.sql
[0m22:13:20.616905 [debug] [MainThread]: Partial parsing: deleted file: dbtlearn://models/example/my_second_dbt_model.sql
[0m22:13:20.655806 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m22:13:20.697470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example
[0m22:13:20.704804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baab89fa-57f7-4e2f-a100-ccfcac2b5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aeba9e20>]}
[0m22:13:20.727186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baab89fa-57f7-4e2f-a100-ccfcac2b5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aeb0aeb0>]}
[0m22:13:20.728096 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:13:20.728706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baab89fa-57f7-4e2f-a100-ccfcac2b5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aeb0ae80>]}
[0m22:13:20.730180 [info ] [MainThread]: 
[0m22:13:20.730957 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:13:20.731745 [debug] [MainThread]: Command end result
[0m22:13:20.742617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aeb0aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aeb10070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aea38070>]}
[0m22:13:20.743091 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 22:15:56.243980 | 72eb4143-0b5b-42c0-b95a-98b37e4512b5 ==============================
[0m22:15:56.243980 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:15:56.248274 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:15:56.249424 [debug] [MainThread]: Tracking: tracking
[0m22:15:56.250216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec081bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec081bddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec081bdd00>]}
[0m22:15:56.359085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:56.359486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:56.360397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example
[0m22:15:56.370519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72eb4143-0b5b-42c0-b95a-98b37e4512b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec08203f40>]}
[0m22:15:56.382798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72eb4143-0b5b-42c0-b95a-98b37e4512b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec082a7580>]}
[0m22:15:56.383451 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:15:56.383930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72eb4143-0b5b-42c0-b95a-98b37e4512b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec082a7610>]}
[0m22:15:56.385391 [info ] [MainThread]: 
[0m22:15:56.386073 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:56.386629 [debug] [MainThread]: Command end result
[0m22:15:56.395458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec082a7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec082a7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec082a7070>]}
[0m22:15:56.395919 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 22:18:15.694034 | ff13d9ca-9867-4e16-ae82-4b9a790894ef ==============================
[0m22:18:15.694034 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:18:15.698269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:18:15.699457 [debug] [MainThread]: Tracking: tracking
[0m22:18:15.700524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e1bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e1bddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e1bdd00>]}
[0m22:18:15.804082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:15.804494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:15.805368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtlearn.example
[0m22:18:15.815081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff13d9ca-9867-4e16-ae82-4b9a790894ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e202fa0>]}
[0m22:18:15.827093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff13d9ca-9867-4e16-ae82-4b9a790894ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e2a45e0>]}
[0m22:18:15.827750 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:18:15.828183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff13d9ca-9867-4e16-ae82-4b9a790894ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e2a4670>]}
[0m22:18:15.831095 [info ] [MainThread]: 
[0m22:18:15.831840 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:18:15.832389 [debug] [MainThread]: Command end result
[0m22:18:15.840489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e2a40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e2a41c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2e2a4100>]}
[0m22:18:15.840937 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 22:21:26.706390 | 1749cc07-b880-40a7-b02b-b006a2b85f2d ==============================
[0m22:21:26.706390 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:21:26.710645 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:21:26.711212 [debug] [MainThread]: Tracking: tracking
[0m22:21:26.712725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66913e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66913edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66913ed00>]}
[0m22:21:26.748402 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:21:26.748962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1749cc07-b880-40a7-b02b-b006a2b85f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66913e6d0>]}
[0m22:21:27.799052 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m22:21:27.865677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1749cc07-b880-40a7-b02b-b006a2b85f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6691be0d0>]}
[0m22:21:27.876118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1749cc07-b880-40a7-b02b-b006a2b85f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66913e610>]}
[0m22:21:27.876647 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:21:27.877283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1749cc07-b880-40a7-b02b-b006a2b85f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb669188100>]}
[0m22:21:27.880665 [info ] [MainThread]: 
[0m22:21:27.951722 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:21:27.952398 [debug] [MainThread]: Command end result
[0m22:21:27.963914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66912baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6691bec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6691bef40>]}
[0m22:21:27.964666 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 22:24:12.537569 | 3059c04a-945c-4616-adcd-6d1c7100e49a ==============================
[0m22:24:12.537569 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:24:12.542106 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:24:12.542879 [debug] [MainThread]: Tracking: tracking
[0m22:24:12.544090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7113f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7113fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7113fd00>]}
[0m22:24:12.649029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:24:12.649739 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
[0m22:24:12.670025 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m22:24:12.700312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3059c04a-945c-4616-adcd-6d1c7100e49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed714310d0>]}
[0m22:24:12.708973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3059c04a-945c-4616-adcd-6d1c7100e49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7112a250>]}
[0m22:24:12.709528 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:24:12.709988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3059c04a-945c-4616-adcd-6d1c7100e49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed71278e80>]}
[0m22:24:12.711598 [info ] [MainThread]: 
[0m22:24:12.713740 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:12.715015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m22:24:12.736604 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m22:24:12.737020 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m22:24:12.737335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:14.674930 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m22:24:14.677846 [debug] [ThreadPool]: On list_airbnb: Close
[0m22:24:14.955575 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_airbnb_dev'
[0m22:24:14.956626 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_airbnb_dev'
[0m22:24:14.957094 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='airbnb', schema='dev', identifier=None)"
[0m22:24:14.963537 [debug] [ThreadPool]: Using snowflake connection "create_airbnb_dev"
[0m22:24:14.963902 [debug] [ThreadPool]: On create_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "create_airbnb_dev"} */
create schema if not exists airbnb.dev
[0m22:24:14.964180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:16.219229 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:16.221574 [debug] [ThreadPool]: On create_airbnb_dev: Close
[0m22:24:16.472647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m22:24:16.482051 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m22:24:16.482455 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m22:24:16.482743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:17.722607 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1 seconds
[0m22:24:17.725698 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m22:24:17.973204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3059c04a-945c-4616-adcd-6d1c7100e49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7161b760>]}
[0m22:24:17.974873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:17.975948 [info ] [MainThread]: 
[0m22:24:17.986623 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m22:24:17.987485 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.src_listings ................................... [RUN]
[0m22:24:17.988676 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m22:24:17.989090 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m22:24:17.991672 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m22:24:17.993045 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 22:24:17.989324 => 2023-01-31 22:24:17.992905
[0m22:24:17.993529 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m22:24:18.037146 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m22:24:18.038848 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m22:24:18.039137 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m22:24:18.039384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:19.203079 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m22:24:19.231748 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 22:24:17.993797 => 2023-01-31 22:24:19.231673
[0m22:24:19.232122 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m22:24:19.496479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3059c04a-945c-4616-adcd-6d1c7100e49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7161b760>]}
[0m22:24:19.499037 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.51s]
[0m22:24:19.504309 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m22:24:19.507049 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:19.508366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:19.508834 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m22:24:19.509440 [info ] [MainThread]: 
[0m22:24:19.510478 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m22:24:19.511355 [debug] [MainThread]: Command end result
[0m22:24:19.520700 [info ] [MainThread]: 
[0m22:24:19.521295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:19.521926 [info ] [MainThread]: 
[0m22:24:19.522528 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:24:19.523180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed71402c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed71402d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed71402fd0>]}
[0m22:24:19.524131 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 22:29:55.575733 | a512ea58-fc0a-4a95-aaa3-13a7b7d24514 ==============================
[0m22:29:55.575733 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:29:55.582161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:29:55.582831 [debug] [MainThread]: Tracking: tracking
[0m22:29:55.584235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb13f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb13fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb13fd00>]}
[0m22:29:55.725725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:29:55.726329 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/src/src_reviews.sql
[0m22:29:55.747000 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m22:29:55.779061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a512ea58-fc0a-4a95-aaa3-13a7b7d24514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb2f60d0>]}
[0m22:29:55.790335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a512ea58-fc0a-4a95-aaa3-13a7b7d24514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb294940>]}
[0m22:29:55.790875 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:29:55.791305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a512ea58-fc0a-4a95-aaa3-13a7b7d24514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb2949d0>]}
[0m22:29:55.793100 [info ] [MainThread]: 
[0m22:29:55.795429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:55.796836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m22:29:55.820943 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m22:29:55.822756 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m22:29:55.824661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:05.267610 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 9 seconds
[0m22:30:05.270566 [debug] [ThreadPool]: On list_airbnb: Close
[0m22:30:05.541804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m22:30:05.554463 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m22:30:05.554871 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m22:30:05.555153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:06.489527 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1 seconds
[0m22:30:06.491872 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m22:30:06.749041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a512ea58-fc0a-4a95-aaa3-13a7b7d24514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb306490>]}
[0m22:30:06.750178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:30:06.750646 [info ] [MainThread]: 
[0m22:30:06.758270 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_reviews
[0m22:30:06.758813 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m22:30:06.759237 [info ] [Thread-2  ]: 2 of 2 START sql view model dev.src_reviews .................................... [RUN]
[0m22:30:06.759820 [info ] [Thread-1  ]: 1 of 2 START sql view model dev.src_listings ................................... [RUN]
[0m22:30:06.760709 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m22:30:06.761415 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m22:30:06.761765 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_reviews
[0m22:30:06.762079 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m22:30:06.764143 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m22:30:06.765971 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m22:30:06.767113 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 22:30:06.762308 => 2023-01-31 22:30:06.766974
[0m22:30:06.767592 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_reviews
[0m22:30:06.773916 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 22:30:06.764394 => 2023-01-31 22:30:06.773776
[0m22:30:06.781277 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m22:30:06.848117 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m22:30:06.849571 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m22:30:06.849883 [debug] [Thread-2  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m22:30:06.850135 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:30:06.853686 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m22:30:06.856080 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m22:30:06.856672 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m22:30:06.857862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:30:08.393866 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m22:30:08.403000 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m22:30:08.438276 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 22:30:06.787977 => 2023-01-31 22:30:08.438196
[0m22:30:08.440123 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 22:30:06.768008 => 2023-01-31 22:30:08.440062
[0m22:30:08.440416 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m22:30:08.440706 [debug] [Thread-2  ]: On model.dbtlearn.src_reviews: Close
[0m22:30:08.702449 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a512ea58-fc0a-4a95-aaa3-13a7b7d24514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb53c100>]}
[0m22:30:08.703151 [info ] [Thread-2  ]: 2 of 2 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.94s]
[0m22:30:08.706640 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_reviews
[0m22:30:08.708649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a512ea58-fc0a-4a95-aaa3-13a7b7d24514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb306550>]}
[0m22:30:08.709742 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.95s]
[0m22:30:08.710659 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m22:30:08.712730 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:30:08.713715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:08.714026 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m22:30:08.714259 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m22:30:08.714552 [info ] [MainThread]: 
[0m22:30:08.715045 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 12.92 seconds (12.92s).
[0m22:30:08.715873 [debug] [MainThread]: Command end result
[0m22:30:08.728396 [info ] [MainThread]: 
[0m22:30:08.729050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:30:08.729622 [info ] [MainThread]: 
[0m22:30:08.730139 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:30:08.730783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb570ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb65d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8bb2d60d0>]}
[0m22:30:08.731359 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 22:55:58.469213 | 7a767797-343e-4b52-b5a6-5ecdca469e4f ==============================
[0m22:55:58.469213 [info ] [MainThread]: Running with dbt=1.4.1
[0m22:55:58.476308 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:55:58.477096 [debug] [MainThread]: Tracking: tracking
[0m22:55:58.478081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3b93e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3b93edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3b93ed00>]}
[0m22:55:58.583777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:55:58.584446 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_hosts.sql
[0m22:55:58.604729 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m22:55:58.636110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3baf4f10>]}
[0m22:55:58.649291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3ba94d00>]}
[0m22:55:58.650091 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m22:55:58.650652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3ba94fa0>]}
[0m22:55:58.652467 [info ] [MainThread]: 
[0m22:55:58.654874 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:58.656500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m22:55:58.678458 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m22:55:58.678857 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m22:55:58.679174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:00.330597 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m22:56:00.333883 [debug] [ThreadPool]: On list_airbnb: Close
[0m22:56:00.608987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m22:56:00.618432 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m22:56:00.618828 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m22:56:00.619114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:56:01.584984 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1 seconds
[0m22:56:01.588251 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m22:56:01.849818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3bb0f3a0>]}
[0m22:56:01.850868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:56:01.851277 [info ] [MainThread]: 
[0m22:56:01.859738 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m22:56:01.860270 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m22:56:01.860685 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m22:56:01.861152 [info ] [Thread-1  ]: 1 of 4 START sql view model dev.src_hosts ...................................... [RUN]
[0m22:56:01.861848 [info ] [Thread-2  ]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m22:56:01.862488 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m22:56:01.863877 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m22:56:01.865173 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m22:56:01.865934 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m22:56:01.866292 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m22:56:01.866626 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m22:56:01.866922 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m22:56:01.869001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m22:56:01.871301 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m22:56:01.873464 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m22:56:01.886843 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 22:56:01.867146 => 2023-01-31 22:56:01.886672
[0m22:56:01.887324 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 22:56:01.869333 => 2023-01-31 22:56:01.887247
[0m22:56:01.887685 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m22:56:01.888092 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m22:56:01.894851 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 22:56:01.871693 => 2023-01-31 22:56:01.894744
[0m22:56:01.913275 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m22:56:01.985515 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m22:56:01.988647 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m22:56:01.992208 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m22:56:01.993578 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m22:56:01.993879 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m22:56:01.994140 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:56:01.996967 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m22:56:01.997895 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m22:56:01.998140 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m22:56:01.998668 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m22:56:02.000090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:56:02.000706 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:56:03.653990 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m22:56:03.678503 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 22:56:01.888382 => 2023-01-31 22:56:03.678419
[0m22:56:03.678892 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m22:56:03.697063 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m22:56:03.706715 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 22:56:01.919241 => 2023-01-31 22:56:03.706642
[0m22:56:03.707060 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m22:56:03.826794 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m22:56:03.833151 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 22:56:01.895187 => 2023-01-31 22:56:03.833063
[0m22:56:03.833907 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m22:56:03.924408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3bea4e80>]}
[0m22:56:03.925217 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.06s]
[0m22:56:03.928488 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m22:56:03.999530 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3b8c78b0>]}
[0m22:56:04.000311 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.13s]
[0m22:56:04.001005 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m22:56:04.104197 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3bdc5040>]}
[0m22:56:04.105143 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.24s]
[0m22:56:04.105820 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m22:56:04.106683 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m22:56:04.107101 [info ] [Thread-4  ]: 4 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m22:56:04.108125 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m22:56:04.108474 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m22:56:04.112478 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m22:56:04.113463 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 22:56:04.108698 => 2023-01-31 22:56:04.113363
[0m22:56:04.113998 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m22:56:04.120560 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m22:56:04.122883 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m22:56:04.123217 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m22:56:04.123470 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:56:05.485095 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m22:56:05.488790 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 22:56:04.114377 => 2023-01-31 22:56:05.488658
[0m22:56:05.489209 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m22:56:05.747777 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a767797-343e-4b52-b5a6-5ecdca469e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3b9b6ee0>]}
[0m22:56:05.748587 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.64s]
[0m22:56:05.749303 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m22:56:05.752575 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:56:05.753885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:05.754472 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m22:56:05.754865 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m22:56:05.755096 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m22:56:05.755306 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m22:56:05.755637 [info ] [MainThread]: 
[0m22:56:05.756919 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m22:56:05.757955 [debug] [MainThread]: Command end result
[0m22:56:05.775561 [info ] [MainThread]: 
[0m22:56:05.776588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:05.777861 [info ] [MainThread]: 
[0m22:56:05.778494 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:56:05.779129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3beb1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3bac4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3ba94c40>]}
[0m22:56:05.779793 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:03:01.706702 | be000409-28f1-49a0-a6a0-66602b1f49be ==============================
[0m23:03:01.706702 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:03:01.710230 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:03:01.711233 [debug] [MainThread]: Tracking: tracking
[0m23:03:01.712183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2097e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2097edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2097ed00>]}
[0m23:03:01.827585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:03:01.828201 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m23:03:01.848580 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m23:03:01.880410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20c6eeb0>]}
[0m23:03:01.894071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20c0cf40>]}
[0m23:03:01.894787 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:03:01.895364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20c0cc40>]}
[0m23:03:01.897237 [info ] [MainThread]: 
[0m23:03:01.899342 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:01.901125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:03:01.928056 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:03:01.928567 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:03:01.928903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:03.645340 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:03:03.648919 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:03:04.393929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:03:04.403303 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:03:04.403687 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:03:04.403971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:05.614781 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m23:03:05.618106 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:03:05.973968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20c864f0>]}
[0m23:03:05.975261 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:05.975693 [info ] [MainThread]: 
[0m23:03:05.996316 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:03:05.997618 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:03:05.998332 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:03:05.999005 [info ] [Thread-1  ]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:03:05.999592 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m23:03:06.000266 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m23:03:06.001175 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:03:06.001903 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:03:06.002646 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:03:06.003080 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:03:06.003428 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:03:06.003962 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:03:06.006283 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:03:06.008185 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:03:06.010004 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:03:06.018562 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:03:06.004358 => 2023-01-31 23:03:06.018285
[0m23:03:06.019321 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:03:06.019680 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:03:06.008443 => 2023-01-31 23:03:06.019597
[0m23:03:06.026844 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:03:06.006563 => 2023-01-31 23:03:06.026731
[0m23:03:06.042660 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:03:06.065197 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:03:06.066997 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:03:06.071372 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:03:06.077038 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:03:06.078715 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:03:06.079618 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:03:06.079859 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:03:06.080180 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:03:06.081578 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:03:06.082020 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:03:06.082305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:06.082572 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:03:06.086893 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:03:07.862638 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:03:07.891563 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:03:06.071665 => 2023-01-31 23:03:07.891479
[0m23:03:07.891965 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:03:07.969765 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:03:07.974784 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:03:06.019900 => 2023-01-31 23:03:07.974695
[0m23:03:07.975181 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:03:08.146260 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:03:08.151938 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:03:06.067313 => 2023-01-31 23:03:08.151863
[0m23:03:08.152283 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:03:08.286770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20f0efd0>]}
[0m23:03:08.288831 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.29s]
[0m23:03:08.292603 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:03:08.293606 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:03:08.294609 [info ] [Thread-4  ]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m23:03:08.296429 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:03:08.296919 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:03:08.301337 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:03:08.304178 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:03:08.297284 => 2023-01-31 23:03:08.304017
[0m23:03:08.304705 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:03:08.309780 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:03:08.311028 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:03:08.311309 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m23:03:08.311559 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:03:08.318823 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20e92910>]}
[0m23:03:08.320178 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.32s]
[0m23:03:08.323130 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:03:08.324440 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:03:08.325301 [info ] [Thread-1  ]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m23:03:08.327216 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:03:08.327918 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:03:08.334901 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:03:08.338349 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:03:08.328328 => 2023-01-31 23:03:08.336439
[0m23:03:08.339447 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:03:08.349454 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:03:08.352106 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:03:08.359518 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m23:03:08.360068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:08.449732 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20e9d1f0>]}
[0m23:03:08.451246 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.45s]
[0m23:03:08.452186 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:03:09.513795 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01aa06e7-0000-f275-0000-000371266175
[0m23:03:09.514469 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 4 unexpected 'is_superhost'.
[0m23:03:09.515283 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:03:08.304979 => 2023-01-31 23:03:09.515134
[0m23:03:09.516171 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:03:09.840479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:03:09.845762 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:03:08.340376 => 2023-01-31 23:03:09.845675
[0m23:03:09.846178 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:03:10.070807 [debug] [Thread-4  ]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 4 unexpected 'is_superhost'.
  compiled Code at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m23:03:10.071837 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20f0ec40>]}
[0m23:03:10.072862 [error] [Thread-4  ]: 4 of 5 ERROR creating sql view model dev.dim_hosts_cleansed .................... [[31mERROR[0m in 1.78s]
[0m23:03:10.074030 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:03:10.130410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be000409-28f1-49a0-a6a0-66602b1f49be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20e92160>]}
[0m23:03:10.131394 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.80s]
[0m23:03:10.132209 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:03:10.134186 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:10.135077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:10.135366 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:03:10.135593 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m23:03:10.135808 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m23:03:10.136016 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:03:10.136310 [info ] [MainThread]: 
[0m23:03:10.136692 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m23:03:10.137377 [debug] [MainThread]: Command end result
[0m23:03:10.147828 [info ] [MainThread]: 
[0m23:03:10.148656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:03:10.149160 [info ] [MainThread]: 
[0m23:03:10.149814 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)[0m
[0m23:03:10.150331 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m23:03:10.150695 [error] [MainThread]:   syntax error line 10 at position 4 unexpected 'is_superhost'.
[0m23:03:10.151035 [error] [MainThread]:   compiled Code at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m23:03:10.151390 [info ] [MainThread]: 
[0m23:03:10.151765 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:03:10.152287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d210ce3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20c0cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20c0ce80>]}
[0m23:03:10.152725 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:03:39.643459 | a260b243-234f-4fc5-93b4-7fd9a5adcd99 ==============================
[0m23:03:39.643459 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:03:39.647266 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:03:39.647873 [debug] [MainThread]: Tracking: tracking
[0m23:03:39.648951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86020bf250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86020bfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86020bfd00>]}
[0m23:03:39.747149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:03:39.748060 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m23:03:39.774225 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m23:03:39.804936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86023b1970>]}
[0m23:03:39.814900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860234ef40>]}
[0m23:03:39.815464 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:03:39.815937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860234eee0>]}
[0m23:03:39.817977 [info ] [MainThread]: 
[0m23:03:39.820428 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:39.822026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:03:39.846013 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:03:39.846502 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:03:39.846849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:41.398516 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:03:41.400811 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:03:41.679715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:03:41.689355 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:03:41.689812 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:03:41.690180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:42.958679 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m23:03:42.962076 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:03:43.270679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86023c94f0>]}
[0m23:03:43.271792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:43.272319 [info ] [MainThread]: 
[0m23:03:43.280048 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:03:43.280543 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:03:43.280888 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:03:43.281285 [info ] [Thread-1  ]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:03:43.281860 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m23:03:43.282411 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m23:03:43.283324 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:03:43.284028 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:03:43.284712 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:03:43.285051 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:03:43.285366 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:03:43.285664 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:03:43.287971 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:03:43.291857 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:03:43.294277 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:03:43.295487 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:03:43.285891 => 2023-01-31 23:03:43.295303
[0m23:03:43.296224 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:03:43.296655 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:03:43.292304 => 2023-01-31 23:03:43.296533
[0m23:03:43.302924 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:03:43.288327 => 2023-01-31 23:03:43.302814
[0m23:03:43.309659 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:03:43.328124 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:03:43.342718 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:03:43.347182 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:03:43.352622 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:03:43.354132 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:03:43.355094 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:03:43.356039 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:03:43.356274 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:03:43.356631 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:03:43.356896 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:03:43.357164 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:03:43.357421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:43.357665 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:03:45.030045 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:03:45.059420 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:03:43.296913 => 2023-01-31 23:03:45.059334
[0m23:03:45.059834 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:03:45.107496 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:03:45.112801 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:03:43.343083 => 2023-01-31 23:03:45.112731
[0m23:03:45.113148 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:03:45.184436 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:03:45.189965 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:03:43.347490 => 2023-01-31 23:03:45.189896
[0m23:03:45.190288 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:03:45.313990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8602748fa0>]}
[0m23:03:45.314816 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.03s]
[0m23:03:45.318143 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:03:45.319032 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:03:45.319514 [info ] [Thread-4  ]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m23:03:45.320617 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:03:45.321020 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:03:45.324572 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:03:45.325331 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:03:45.321244 => 2023-01-31 23:03:45.325237
[0m23:03:45.325710 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:03:45.331513 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:03:45.332870 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:03:45.333238 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m23:03:45.333542 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:03:45.391632 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8603053970>]}
[0m23:03:45.392431 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.11s]
[0m23:03:45.393085 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:03:45.566525 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8603091820>]}
[0m23:03:45.567319 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.28s]
[0m23:03:45.567980 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:03:45.568731 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:03:45.569177 [info ] [Thread-1  ]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m23:03:45.570049 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:03:45.570389 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:03:45.573907 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:03:45.574608 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:03:45.570606 => 2023-01-31 23:03:45.574525
[0m23:03:45.574949 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:03:45.579323 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:03:45.580911 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:03:45.581276 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m23:03:45.581533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:46.460647 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:03:46.464041 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:03:45.325943 => 2023-01-31 23:03:46.463964
[0m23:03:46.465042 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:03:46.722518 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86026f2dc0>]}
[0m23:03:46.723334 [info ] [Thread-4  ]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.40s]
[0m23:03:46.724209 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:03:46.774022 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:03:46.779929 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:03:45.575164 => 2023-01-31 23:03:46.779797
[0m23:03:46.780668 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:03:47.055388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a260b243-234f-4fc5-93b4-7fd9a5adcd99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8603092cd0>]}
[0m23:03:47.056189 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.49s]
[0m23:03:47.056852 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:03:47.058873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:47.059568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:47.059845 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:03:47.060076 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m23:03:47.060297 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m23:03:47.060529 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:03:47.060841 [info ] [MainThread]: 
[0m23:03:47.061274 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.24 seconds (7.24s).
[0m23:03:47.062097 [debug] [MainThread]: Command end result
[0m23:03:47.070534 [info ] [MainThread]: 
[0m23:03:47.071048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:47.071436 [info ] [MainThread]: 
[0m23:03:47.071803 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:03:47.072262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86026da3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f860308ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86026f2dc0>]}
[0m23:03:47.072630 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:07:59.126956 | 2146db9a-ee08-4720-833c-4b04bae5af9b ==============================
[0m23:07:59.126956 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:07:59.133873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:07:59.134590 [debug] [MainThread]: Tracking: tracking
[0m23:07:59.135448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab17e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab17edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab17ed00>]}
[0m23:07:59.175828 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:07:59.176424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab17e6d0>]}
[0m23:08:00.224519 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m23:08:00.241785 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m23:08:00.246476 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m23:08:00.250629 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m23:08:00.255022 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m23:08:00.308178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab21d0d0>]}
[0m23:08:00.320848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab17eb20>]}
[0m23:08:00.321414 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:08:00.321920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab16aa30>]}
[0m23:08:00.324244 [info ] [MainThread]: 
[0m23:08:00.326604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:08:00.328246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:08:00.349718 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:08:00.350274 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:08:00.350704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:01.863835 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:08:01.867327 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:08:02.128250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:08:02.137971 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:08:02.138403 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:08:02.138698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:03.514234 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m23:08:03.517335 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:08:03.786196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab16aa30>]}
[0m23:08:03.787212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:03.787654 [info ] [MainThread]: 
[0m23:08:03.807742 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:08:03.808765 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:08:03.809700 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:08:03.810319 [info ] [Thread-1  ]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:08:03.811372 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m23:08:03.812137 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m23:08:03.813189 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:08:03.813924 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:08:03.814766 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:08:03.815756 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:08:03.816326 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:08:03.817031 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:08:03.819599 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:08:03.822744 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:08:03.824997 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:08:03.826718 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:08:03.823158 => 2023-01-31 23:08:03.826567
[0m23:08:03.827073 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:08:03.817553 => 2023-01-31 23:08:03.827002
[0m23:08:03.827410 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:08:03.827791 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:08:03.892615 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:08:03.819890 => 2023-01-31 23:08:03.892493
[0m23:08:03.898326 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:08:03.914421 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:08:03.918653 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:08:03.920042 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:08:03.920380 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:08:03.920653 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:08:03.927361 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:08:03.928817 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:08:03.929166 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:08:03.929453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:08:03.931205 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:08:03.932172 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:08:03.932897 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:08:05.412286 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:08:05.441200 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:08:03.898867 => 2023-01-31 23:08:05.441121
[0m23:08:05.441584 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:08:05.457024 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:08:05.461951 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:08:03.845424 => 2023-01-31 23:08:05.461877
[0m23:08:05.462323 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:08:05.680869 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:08:05.687230 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:08:03.828045 => 2023-01-31 23:08:05.687153
[0m23:08:05.687596 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:08:05.699804 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab701ee0>]}
[0m23:08:05.700559 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.89s]
[0m23:08:05.704316 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:08:05.705401 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:08:05.706229 [info ] [Thread-4  ]: 4 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:08:05.707756 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:08:05.708377 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:08:05.713345 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:08:05.714448 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:08:05.708634 => 2023-01-31 23:08:05.714337
[0m23:08:05.714845 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:08:05.733566 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m23:08:05.744524 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:08:05.745090 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m23:08:05.745530 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:08:05.747546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab7e7a90>]}
[0m23:08:05.748902 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.93s]
[0m23:08:05.749571 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:08:05.750811 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:08:05.751940 [info ] [Thread-2  ]: 5 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:08:05.753902 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:08:05.754516 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:08:05.759218 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:08:05.760437 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:08:05.754887 => 2023-01-31 23:08:05.760325
[0m23:08:05.760823 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:08:05.765224 [debug] [Thread-2  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m23:08:05.768907 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:08:05.769301 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m23:08:05.769575 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:08:05.943349 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fac05fa00>]}
[0m23:08:05.944259 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.13s]
[0m23:08:05.945031 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:08:07.312080 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:08:07.314238 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:08:07.346640 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:08:07.350149 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:08:07.352131 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:08:07.353399 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:08:07.353646 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:08:07.353913 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:08:08.180288 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:08:08.192364 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:08:05.715072 => 2023-01-31 23:08:08.192290
[0m23:08:08.192748 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:08:08.464923 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab701a90>]}
[0m23:08:08.465722 [info ] [Thread-4  ]: 4 of 5 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.76s]
[0m23:08:08.466451 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:08:08.590371 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:08:08.594109 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:08:05.761048 => 2023-01-31 23:08:08.594036
[0m23:08:08.594461 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:08:08.838570 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2146db9a-ee08-4720-833c-4b04bae5af9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab7e7c70>]}
[0m23:08:08.839361 [info ] [Thread-2  ]: 5 of 5 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 3.09s]
[0m23:08:08.840083 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:08:08.842280 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:08:08.843026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:08.843292 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m23:08:08.843518 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:08:08.843736 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m23:08:08.843950 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:08:08.844253 [info ] [MainThread]: 
[0m23:08:08.844638 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m23:08:08.845358 [debug] [MainThread]: Command end result
[0m23:08:08.853970 [info ] [MainThread]: 
[0m23:08:08.854586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:08:08.855063 [info ] [MainThread]: 
[0m23:08:08.855514 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:08:08.856085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fac03aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab17ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fab6fae20>]}
[0m23:08:08.856467 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:20:03.465609 | 5c092800-1282-4c6b-8360-4014ac986bf7 ==============================
[0m23:20:03.465609 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:20:03.470299 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:20:03.471045 [debug] [MainThread]: Tracking: tracking
[0m23:20:03.472519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fdb17f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fdb17fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fdb17fd00>]}
[0m23:20:03.563663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:20:03.564262 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fact_reviews.sql
[0m23:20:03.586335 [debug] [MainThread]: 1603: static parser failed on fct/fact_reviews.sql
[0m23:20:03.591776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fdb261a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fdb1d57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fdb1d5850>]}
[0m23:20:03.592243 [debug] [MainThread]: Flushing usage events
[0m23:20:04.792013 [error] [MainThread]: Encountered an error:
Compilation Error in model fact_reviews (models/fct/fact_reviews.sql)
  unexpected '}'
    line 13
      {% if is_incremental() *}


============================== 2023-01-31 23:23:36.951520 | 1b123033-892d-4067-93b4-c8017e67b1ce ==============================
[0m23:23:36.951520 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:23:36.955524 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:23:36.956160 [debug] [MainThread]: Tracking: tracking
[0m23:23:36.957151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83929be250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83929bedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83929bed00>]}
[0m23:23:37.053878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:23:37.054478 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fact_reviews.sql
[0m23:23:37.076682 [debug] [MainThread]: 1603: static parser failed on fct/fact_reviews.sql
[0m23:23:37.104613 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fact_reviews.sql
[0m23:23:37.119427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392b710d0>]}
[0m23:23:37.131146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392b19df0>]}
[0m23:23:37.131853 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:23:37.132388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392b19f10>]}
[0m23:23:37.134545 [info ] [MainThread]: 
[0m23:23:37.136781 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:23:37.138485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:23:37.222629 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:23:37.223031 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:23:37.223334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:45.110251 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 8 seconds
[0m23:23:45.113849 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:23:45.402837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:23:45.413134 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:23:45.413536 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:23:45.413827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:46.734662 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1 seconds
[0m23:23:46.738007 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:23:46.997244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392d70040>]}
[0m23:23:46.998270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:23:46.998705 [info ] [MainThread]: 
[0m23:23:47.007320 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:23:47.007793 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:23:47.008125 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:23:47.008515 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:23:47.009143 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m23:23:47.009716 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m23:23:47.010651 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:23:47.011355 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:23:47.012028 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:23:47.012369 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:23:47.012680 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:23:47.012974 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:23:47.015000 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:23:47.017659 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:23:47.020158 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:23:47.021775 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:23:47.018335 => 2023-01-31 23:23:47.021523
[0m23:23:47.022266 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:23:47.013200 => 2023-01-31 23:23:47.022174
[0m23:23:47.023003 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:23:47.024009 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:23:47.030738 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:23:47.015260 => 2023-01-31 23:23:47.030628
[0m23:23:47.085095 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:23:47.113802 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:23:47.119960 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:23:47.121911 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:23:47.123156 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:23:47.124034 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:23:47.124441 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:23:47.124789 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:23:47.125148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:23:47.126004 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:23:47.126238 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:23:47.127747 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:23:47.130486 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:23:48.624175 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:23:48.656152 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:23:47.024305 => 2023-01-31 23:23:48.656057
[0m23:23:48.656547 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:23:48.697565 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:23:48.700955 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:23:47.097475 => 2023-01-31 23:23:48.700888
[0m23:23:48.701259 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:23:48.911668 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392efaf40>]}
[0m23:23:48.912484 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.90s]
[0m23:23:48.916411 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:23:48.917270 [debug] [Thread-4  ]: Began running node model.dbtlearn.fact_reviews
[0m23:23:48.917893 [info ] [Thread-4  ]: 4 of 6 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:23:48.918977 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:23:48.919316 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:23:48.924731 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:23:48.925542 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:23:48.919532 => 2023-01-31 23:23:48.925456
[0m23:23:48.925885 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:23:48.990630 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392e403d0>]}
[0m23:23:48.997297 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:23:49.005880 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:23:49.006599 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.98s]
[0m23:23:49.011226 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:23:47.031083 => 2023-01-31 23:23:49.011153
[0m23:23:49.011887 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:23:49.012289 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:23:49.013180 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:23:49.014053 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:23:49.015715 [info ] [Thread-3  ]: 5 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:23:49.016339 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
        (

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


        );
[0m23:23:49.017785 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:23:49.018219 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:23:49.018708 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:23:49.024968 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:23:49.027342 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:23:49.020762 => 2023-01-31 23:23:49.027111
[0m23:23:49.028258 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:23:49.047478 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:23:49.049337 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:23:49.049847 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:23:49.050167 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:23:49.303502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392f09ac0>]}
[0m23:23:49.304327 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.29s]
[0m23:23:49.305151 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:23:49.305997 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:23:49.306415 [info ] [Thread-2  ]: 6 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:23:49.307290 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:23:49.307611 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:23:49.311314 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:23:49.312590 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:23:49.307828 => 2023-01-31 23:23:49.312383
[0m23:23:49.313137 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:23:49.316863 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:23:49.318095 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:23:49.318364 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:23:49.318611 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:23:52.844773 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m23:23:52.856400 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:23:49.313383 => 2023-01-31 23:23:52.856317
[0m23:23:52.856824 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:23:53.113151 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83931657f0>]}
[0m23:23:53.113955 [info ] [Thread-2  ]: 6 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 3.81s]
[0m23:23:53.114798 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:23:53.147670 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m23:23:53.153026 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:23:49.029004 => 2023-01-31 23:23:53.152953
[0m23:23:53.153402 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:23:53.424495 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392f16ee0>]}
[0m23:23:53.425286 [info ] [Thread-3  ]: 5 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 4.41s]
[0m23:23:53.425995 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:23:56.173462 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 7 seconds
[0m23:23:56.186767 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:23:56.187138 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:23:56.317238 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:23:56.321822 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:23:48.926099 => 2023-01-31 23:23:56.321679
[0m23:23:56.322213 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: Close
[0m23:23:56.560841 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b123033-892d-4067-93b4-c8017e67b1ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392efe400>]}
[0m23:23:56.561520 [info ] [Thread-4  ]: 4 of 6 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 1[0m in 7.64s]
[0m23:23:56.562120 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:23:56.564716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:23:56.565626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:56.565937 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m23:23:56.566167 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:23:56.566536 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:23:56.566956 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:23:56.567596 [info ] [MainThread]: 
[0m23:23:56.568186 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 19.43 seconds (19.43s).
[0m23:23:56.569173 [debug] [MainThread]: Command end result
[0m23:23:56.580384 [info ] [MainThread]: 
[0m23:23:56.580934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:56.581398 [info ] [MainThread]: 
[0m23:23:56.581853 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:23:56.582420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392d78cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392dbabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8392dba9d0>]}
[0m23:23:56.582842 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:27:16.208803 | a2194179-2083-4d77-ab7f-818d2e6fa729 ==============================
[0m23:27:16.208803 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:27:16.214639 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:27:16.215477 [debug] [MainThread]: Tracking: tracking
[0m23:27:16.216681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c1bf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c1bfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c1bfd00>]}
[0m23:27:16.358079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:16.358481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:16.373901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c209fa0>]}
[0m23:27:16.385642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c2ad8e0>]}
[0m23:27:16.386402 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:27:16.386925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c2ad970>]}
[0m23:27:16.389051 [info ] [MainThread]: 
[0m23:27:16.391284 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:16.394973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:27:16.416891 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:27:16.417335 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:27:16.417677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:17.954851 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:27:17.960154 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:27:18.210267 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:27:18.219676 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:27:18.220059 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:27:18.220352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:19.521316 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m23:27:19.524807 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:27:19.801288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c397100>]}
[0m23:27:19.802263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:27:19.802694 [info ] [MainThread]: 
[0m23:27:19.810683 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:27:19.811175 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:27:19.812175 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:27:19.813063 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:27:19.813751 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m23:27:19.814328 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m23:27:19.815254 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:27:19.815951 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:27:19.816638 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:27:19.816979 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:27:19.817290 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:27:19.817586 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:27:19.819641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:27:19.821859 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:27:19.824454 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:27:19.827507 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:27:19.819890 => 2023-01-31 23:27:19.827316
[0m23:27:19.828360 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:27:19.835468 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:27:19.817811 => 2023-01-31 23:27:19.835357
[0m23:27:19.841671 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:27:19.822282 => 2023-01-31 23:27:19.841563
[0m23:27:19.847341 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:27:19.865892 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:27:19.879437 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:27:19.884749 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:27:19.889992 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:27:19.891787 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:27:19.892141 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:27:19.892407 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:27:19.894949 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:27:19.895276 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:27:19.895553 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:27:19.899066 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:27:19.899472 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:27:19.899759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:21.468389 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:27:21.495427 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:27:19.829032 => 2023-01-31 23:27:21.495344
[0m23:27:21.495826 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:27:21.591682 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:27:21.595100 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:27:19.879793 => 2023-01-31 23:27:21.595029
[0m23:27:21.595435 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:27:21.607075 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:27:21.611028 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:27:19.885097 => 2023-01-31 23:27:21.610957
[0m23:27:21.611375 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:27:21.735656 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c23da60>]}
[0m23:27:21.736538 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.92s]
[0m23:27:21.738722 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:27:21.739907 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:27:21.740648 [info ] [Thread-4  ]: 4 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:27:21.742316 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:27:21.742784 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:27:21.746404 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:27:21.747109 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:27:21.743027 => 2023-01-31 23:27:21.747025
[0m23:27:21.747441 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:27:21.798914 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:27:21.801684 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:27:21.802339 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:27:21.802758 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:27:21.858835 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c6d4400>]}
[0m23:27:21.859589 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.04s]
[0m23:27:21.860238 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:27:21.862998 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c5eb4f0>]}
[0m23:27:21.864133 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.05s]
[0m23:27:21.865212 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:27:21.865927 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:27:21.866778 [info ] [Thread-2  ]: 5 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:27:21.867994 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:27:21.868550 [debug] [Thread-1  ]: Began running node model.dbtlearn.fact_reviews
[0m23:27:21.868904 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:27:21.869346 [info ] [Thread-1  ]: 6 of 6 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:27:21.875675 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:27:21.876072 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:27:21.874676 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:27:21.893800 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:27:21.894937 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:27:21.869836 => 2023-01-31 23:27:21.894798
[0m23:27:21.895575 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:27:21.900935 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:27:21.901670 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:27:21.876303 => 2023-01-31 23:27:21.901494
[0m23:27:21.902303 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:27:21.930973 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:27:21.931471 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:27:21.931849 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:27:22.014795 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:22.016240 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:27:22.016745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:23.843420 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:27:23.855645 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:23.856043 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:27:24.029349 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:27:24.034299 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:24.034618 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:27:24.146536 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:27:24.156801 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:27:21.747652 => 2023-01-31 23:27:24.156727
[0m23:27:24.157174 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:27:24.180012 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:27:24.200369 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:24.200757 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:27:24.345900 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:27:24.350613 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:24.350934 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:27:24.371754 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:27:24.375615 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:27:21.896037 => 2023-01-31 23:27:24.375544
[0m23:27:24.375958 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:27:24.400158 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2d0ebfa0>]}
[0m23:27:24.400789 [info ] [Thread-4  ]: 4 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.66s]
[0m23:27:24.401389 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:27:24.497061 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:27:24.510993 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:27:24.535200 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:27:24.536444 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:24.536733 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:27:24.631994 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2d217310>]}
[0m23:27:24.632626 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.76s]
[0m23:27:24.633277 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:27:24.710103 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:27:24.710540 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:24.710805 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:27:25.584603 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:27:25.585125 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:25.585478 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:27:25.897445 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:27:25.907847 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:27:25.908201 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:27:26.090921 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:27:26.094274 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:27:21.902644 => 2023-01-31 23:27:26.094205
[0m23:27:26.094599 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: Close
[0m23:27:26.375991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2194179-2083-4d77-ab7f-818d2e6fa729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2d0869a0>]}
[0m23:27:26.376630 [info ] [Thread-1  ]: 6 of 6 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 1[0m in 4.50s]
[0m23:27:26.377116 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:27:26.418543 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:26.419366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:26.419660 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:27:26.419890 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:27:26.420112 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m23:27:26.420320 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:27:26.420632 [info ] [MainThread]: 
[0m23:27:26.420990 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 10.03 seconds (10.03s).
[0m23:27:26.422465 [debug] [MainThread]: Command end result
[0m23:27:26.471061 [info ] [MainThread]: 
[0m23:27:26.473890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:26.474487 [info ] [MainThread]: 
[0m23:27:26.475218 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:27:26.475815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c2ad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c628b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2c5817c0>]}
[0m23:27:26.476200 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:30:01.760994 | d1e5e0f5-2c55-4d6e-8433-1f8531500d27 ==============================
[0m23:30:01.760994 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:30:01.765073 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:30:01.765659 [debug] [MainThread]: Tracking: tracking
[0m23:30:01.766483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36797f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36797fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff36797fd00>]}
[0m23:30:01.867668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:30:01.868084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:30:01.878774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3679c8fa0>]}
[0m23:30:01.887918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367a708e0>]}
[0m23:30:01.888469 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:30:01.888925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367a70970>]}
[0m23:30:01.890826 [info ] [MainThread]: 
[0m23:30:01.893132 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:30:01.894875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:30:01.917824 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:30:01.918252 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:30:01.918581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:03.748494 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:30:03.752229 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:30:04.017867 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:30:04.027529 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:30:04.027952 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:30:04.028275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:05.295173 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m23:30:05.298625 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:30:06.054365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367b59130>]}
[0m23:30:06.055426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:30:06.055856 [info ] [MainThread]: 
[0m23:30:06.073185 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:30:06.074136 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:30:06.073616 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:30:06.075212 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:30:06.077671 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:30:06.076796 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.src_listings ................................... [RUN]
[0m23:30:06.082483 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:30:06.075879 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:30:06.083130 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:30:06.081061 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:30:06.084125 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.src_reviews .................................... [RUN]
[0m23:30:06.086409 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:30:06.087497 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:30:06.088230 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:30:06.092800 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:30:06.095129 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:30:06.088587 => 2023-01-31 23:30:06.093972
[0m23:30:06.097845 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:30:06.112155 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:30:06.084617 => 2023-01-31 23:30:06.112045
[0m23:30:06.112570 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:30:06.078075 => 2023-01-31 23:30:06.112465
[0m23:30:06.123399 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:30:06.130241 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:30:06.152525 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:30:06.157736 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:30:06.163200 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:30:06.164996 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:30:06.165820 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:30:06.167187 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:30:06.166895 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:30:06.167447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:06.167727 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:30:06.166621 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:30:06.171107 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:30:06.173611 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:30:07.723307 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:30:07.753074 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:30:06.158251 => 2023-01-31 23:30:07.752992
[0m23:30:07.753468 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:30:07.786924 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:30:07.790988 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:30:06.100896 => 2023-01-31 23:30:07.790910
[0m23:30:07.791375 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:30:08.015583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367ebfee0>]}
[0m23:30:08.016265 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.94s]
[0m23:30:08.019603 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:30:08.022232 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:30:08.022853 [info ] [Thread-4  ]: 4 of 6 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:30:08.023886 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:30:08.024247 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:30:08.027799 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:30:08.030014 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:30:08.024474 => 2023-01-31 23:30:08.029908
[0m23:30:08.030445 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:30:08.049674 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:30:08.059555 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:30:06.152824 => 2023-01-31 23:30:08.059358
[0m23:30:08.060104 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:30:08.080361 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:30:08.083505 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:30:08.084683 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367f08be0>]}
[0m23:30:08.085306 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:30:08.086038 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:30:08.086963 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.00s]
[0m23:30:08.089216 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:30:08.090761 [debug] [Thread-1  ]: Began running node model.dbtlearn.fact_reviews
[0m23:30:08.092186 [info ] [Thread-1  ]: 5 of 6 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:30:08.093729 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:30:08.094660 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:30:08.123515 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:30:08.124541 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:30:08.095388 => 2023-01-31 23:30:08.124421
[0m23:30:08.125092 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:30:08.210410 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:30:08.213055 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:30:08.213539 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace transient table airbnb.dev.fact_reviews  as
        (

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


        );
[0m23:30:08.213913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:30:08.353309 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367fb19d0>]}
[0m23:30:08.353977 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.27s]
[0m23:30:08.354463 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:30:08.355408 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:30:08.355869 [info ] [Thread-3  ]: 6 of 6 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:30:08.356701 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:30:08.357018 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:30:08.360765 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:30:08.361505 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:30:08.357236 => 2023-01-31 23:30:08.361417
[0m23:30:08.361854 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:30:08.365715 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:30:08.367354 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:30:08.367703 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:30:08.368115 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:30:10.041619 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:30:10.051911 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:30:08.030677 => 2023-01-31 23:30:10.051827
[0m23:30:10.052354 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:30:10.510551 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367fbe490>]}
[0m23:30:10.511512 [info ] [Thread-4  ]: 4 of 6 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.49s]
[0m23:30:10.512971 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:30:10.591268 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:30:10.595306 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:30:08.362068 => 2023-01-31 23:30:10.595227
[0m23:30:10.595669 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:30:10.852145 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3688d04f0>]}
[0m23:30:10.852803 [info ] [Thread-3  ]: 6 of 6 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.50s]
[0m23:30:10.853438 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:30:14.139262 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6 seconds
[0m23:30:14.155539 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:30:14.155904 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:30:14.291195 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:30:14.297461 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:30:08.125412 => 2023-01-31 23:30:14.297377
[0m23:30:14.297847 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: Close
[0m23:30:14.757139 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e5e0f5-2c55-4d6e-8433-1f8531500d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367e78490>]}
[0m23:30:14.758178 [info ] [Thread-1  ]: 5 of 6 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 1[0m in 6.66s]
[0m23:30:14.759122 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:30:14.762967 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:30:14.764310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:14.764884 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:30:14.765295 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m23:30:14.765537 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:30:14.765757 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:30:14.766091 [info ] [MainThread]: 
[0m23:30:14.766461 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 12.87 seconds (12.87s).
[0m23:30:14.767410 [debug] [MainThread]: Command end result
[0m23:30:14.780554 [info ] [MainThread]: 
[0m23:30:14.781090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:30:14.781481 [info ] [MainThread]: 
[0m23:30:14.781850 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:30:14.782330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367a70520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368875fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff367fb5c10>]}
[0m23:30:14.782700 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:38:05.401576 | 16088f84-da54-44c5-82d2-9419d12130a3 ==============================
[0m23:38:05.401576 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:38:05.411311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:38:05.412134 [debug] [MainThread]: Tracking: tracking
[0m23:38:05.412994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9497f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9497fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9497fd00>]}
[0m23:38:05.523115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:38:05.523870 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_listings_w_hosts.sql
[0m23:38:05.545389 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m23:38:05.577825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94c980d0>]}
[0m23:38:05.589022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94c18b80>]}
[0m23:38:05.589694 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:38:05.590471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94c18cd0>]}
[0m23:38:05.592647 [info ] [MainThread]: 
[0m23:38:05.594922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:38:05.596688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:38:05.623107 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:38:05.623557 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:38:05.623898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:07.311223 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:38:07.314790 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:38:07.579279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:38:07.588665 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:38:07.589047 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:38:07.589334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:08.840326 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m23:38:08.842878 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:38:09.101361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94c75790>]}
[0m23:38:09.102337 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:09.102778 [info ] [MainThread]: 
[0m23:38:09.111147 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:38:09.111581 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:38:09.112001 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:38:09.112467 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:38:09.113110 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m23:38:09.113675 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m23:38:09.114994 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:38:09.116191 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:38:09.116933 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:38:09.117298 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:38:09.117614 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:38:09.117910 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:38:09.119992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:38:09.122154 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:38:09.124569 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:38:09.126335 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:38:09.122626 => 2023-01-31 23:38:09.126207
[0m23:38:09.126692 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:38:09.120255 => 2023-01-31 23:38:09.126620
[0m23:38:09.126948 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:38:09.118134 => 2023-01-31 23:38:09.126886
[0m23:38:09.127278 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:38:09.127671 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:38:09.128005 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:38:09.200281 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:38:09.205860 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:38:09.208153 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:38:09.209731 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:38:09.210573 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:38:09.210821 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:38:09.211152 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:38:09.212100 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:38:09.212340 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:38:09.212604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:38:09.212854 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:38:09.215559 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:38:10.772751 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:38:10.804810 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:38:09.147337 => 2023-01-31 23:38:10.804731
[0m23:38:10.805206 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:38:10.807159 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:38:10.812623 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:38:09.200681 => 2023-01-31 23:38:10.812552
[0m23:38:10.813091 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:38:11.064744 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94fe3640>]}
[0m23:38:11.065553 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.95s]
[0m23:38:11.069592 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:38:11.070431 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:38:11.071051 [info ] [Thread-4  ]: 4 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:38:11.072064 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:38:11.072402 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:38:11.075824 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:38:11.076526 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:38:11.072619 => 2023-01-31 23:38:11.076438
[0m23:38:11.076870 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:38:11.099380 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:38:11.115482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94fe7400>]}
[0m23:38:11.124209 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:38:11.127370 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:38:09.128247 => 2023-01-31 23:38:11.127300
[0m23:38:11.128148 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.00s]
[0m23:38:11.128693 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:38:11.129452 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:38:11.131103 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:38:11.133655 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:38:11.134153 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:38:11.134661 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:38:11.136516 [info ] [Thread-2  ]: 5 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:38:11.139520 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:38:11.140456 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:38:11.145214 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:38:11.146907 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:38:11.141212 => 2023-01-31 23:38:11.146798
[0m23:38:11.147448 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:38:11.154536 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:38:11.156735 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:38:11.157538 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:38:11.158348 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:38:11.385019 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94e9f250>]}
[0m23:38:11.385845 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.27s]
[0m23:38:11.386584 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:38:11.387413 [debug] [Thread-1  ]: Began running node model.dbtlearn.fact_reviews
[0m23:38:11.387872 [info ] [Thread-1  ]: 6 of 7 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:38:11.388691 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:38:11.389003 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:38:11.401196 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:38:11.403884 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:38:11.389219 => 2023-01-31 23:38:11.403703
[0m23:38:11.404448 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:38:11.459450 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:11.460941 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:38:11.461443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:38:12.557106 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:38:12.571252 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:12.571627 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:38:12.718747 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:38:12.725436 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:12.725749 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:38:12.874233 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:38:12.896115 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:12.896510 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:38:12.971436 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:38:12.983810 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:38:11.147762 => 2023-01-31 23:38:12.983733
[0m23:38:12.984185 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:38:13.046971 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:38:13.049242 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:38:13.056804 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:13.060348 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:38:11.077087 => 2023-01-31 23:38:13.060275
[0m23:38:13.060677 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:38:13.060978 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:38:13.210468 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:38:13.232047 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:38:13.264089 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:38:13.266080 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:13.267085 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9507b8e0>]}
[0m23:38:13.267382 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:38:13.268050 [info ] [Thread-2  ]: 5 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.13s]
[0m23:38:13.269391 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:38:13.306873 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94f30df0>]}
[0m23:38:13.307507 [info ] [Thread-4  ]: 4 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.24s]
[0m23:38:13.308022 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:38:13.308637 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m23:38:13.309090 [info ] [Thread-3  ]: 7 of 7 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m23:38:13.310077 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m23:38:13.310407 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m23:38:13.314424 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:38:13.315122 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-01-31 23:38:13.310623 => 2023-01-31 23:38:13.315038
[0m23:38:13.315470 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m23:38:13.319465 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:38:13.321510 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m23:38:13.321953 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (with
l as (select
*
from 
airbnb.dev.dim_listings_cleansed),
h as (
    select *
    fromairbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at
    GREATEST(l.updated_at,h.updated_at) as updated_at
FROM l
left join h on (h.host_id=l.host_id)
        );
[0m23:38:13.322382 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:38:13.528634 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:38:13.529154 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:13.529479 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:38:13.875537 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0 seconds
[0m23:38:13.876114 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:13.877143 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:38:14.143626 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:38:14.155403 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:38:14.155759 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:38:14.288693 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01aa070a-0000-f27d-0000-000371263275
[0m23:38:14.289155 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 4 unexpected 'fromairbnb'.
syntax error line 12 at position 0 unexpected 'select'.
[0m23:38:14.289920 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-01-31 23:38:13.315691 => 2023-01-31 23:38:14.289789
[0m23:38:14.290283 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m23:38:14.333618 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:38:14.338956 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:38:11.404726 => 2023-01-31 23:38:14.338865
[0m23:38:14.339368 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: Close
[0m23:38:14.541185 [debug] [Thread-3  ]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'fromairbnb'.
  syntax error line 12 at position 0 unexpected 'select'.
  compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m23:38:14.541981 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb95096910>]}
[0m23:38:14.542736 [error] [Thread-3  ]: 7 of 7 ERROR creating sql table model dev.dim_listings_w_hosts ................. [[31mERROR[0m in 1.23s]
[0m23:38:14.543473 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m23:38:14.599467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16088f84-da54-44c5-82d2-9419d12130a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb95276cd0>]}
[0m23:38:14.600266 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.21s]
[0m23:38:14.600974 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:38:14.602836 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:38:14.603541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:14.603806 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:38:14.604031 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:38:14.604249 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m23:38:14.604467 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:38:14.604810 [info ] [MainThread]: 
[0m23:38:14.605189 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m23:38:14.606071 [debug] [MainThread]: Command end result
[0m23:38:14.617274 [info ] [MainThread]: 
[0m23:38:14.617910 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:38:14.618323 [info ] [MainThread]: 
[0m23:38:14.618712 [error] [MainThread]: [33mDatabase Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)[0m
[0m23:38:14.619550 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m23:38:14.620001 [error] [MainThread]:   syntax error line 9 at position 4 unexpected 'fromairbnb'.
[0m23:38:14.620340 [error] [MainThread]:   syntax error line 12 at position 0 unexpected 'select'.
[0m23:38:14.620669 [error] [MainThread]:   compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m23:38:14.621026 [info ] [MainThread]: 
[0m23:38:14.621382 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:38:14.621836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94c18f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb950258e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb94c75340>]}
[0m23:38:14.622213 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:41:01.523995 | 363b9f6b-38ab-4952-8a14-9fa38752f2e7 ==============================
[0m23:41:01.523995 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:41:01.527972 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:41:01.528616 [debug] [MainThread]: Tracking: tracking
[0m23:41:01.529980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4919be100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4919bedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4919bed00>]}
[0m23:41:01.643325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:01.643713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:01.654266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491a0f0d0>]}
[0m23:41:01.664713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491aabca0>]}
[0m23:41:01.665369 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:41:01.665834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491aabd30>]}
[0m23:41:01.667712 [info ] [MainThread]: 
[0m23:41:01.669955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:41:01.671751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:41:01.694446 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:41:01.694860 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:41:01.695188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:05.025663 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m23:41:05.029449 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:41:05.310155 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:41:05.320000 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:41:05.320396 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:41:05.320693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:06.542843 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m23:41:06.546310 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:41:06.902775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4910329d0>]}
[0m23:41:06.903768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:06.904169 [info ] [MainThread]: 
[0m23:41:06.912593 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:41:06.913104 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:41:06.913575 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:41:06.914054 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:41:06.914655 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m23:41:06.915224 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m23:41:06.916764 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:41:06.917701 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:41:06.918400 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:41:06.918746 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:41:06.919062 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:41:06.919429 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:41:06.921583 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:41:06.923885 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:41:06.926170 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:41:06.927845 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:41:06.919717 => 2023-01-31 23:41:06.927681
[0m23:41:06.928202 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:41:06.924259 => 2023-01-31 23:41:06.928129
[0m23:41:06.928458 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:41:06.921866 => 2023-01-31 23:41:06.928397
[0m23:41:06.928793 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:41:06.929197 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:41:06.929539 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:41:07.026095 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:41:07.028203 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:41:07.028898 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:41:07.030083 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:41:07.030614 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:41:07.030904 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:41:07.033424 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:41:07.033763 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:41:07.034034 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:41:07.036044 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:41:07.036539 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:41:07.037514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:08.645990 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:41:08.654166 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:41:08.692088 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:41:06.966591 => 2023-01-31 23:41:08.692009
[0m23:41:08.693674 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:41:06.942157 => 2023-01-31 23:41:08.693613
[0m23:41:08.693964 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:41:08.694264 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:41:08.781543 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:41:08.786606 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:41:06.929782 => 2023-01-31 23:41:08.786519
[0m23:41:08.787036 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:41:08.961353 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491e28940>]}
[0m23:41:08.962189 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.04s]
[0m23:41:08.965506 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:41:08.967255 [debug] [Thread-4  ]: Began running node model.dbtlearn.fact_reviews
[0m23:41:08.968114 [info ] [Thread-4  ]: 4 of 7 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:41:08.969442 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:41:08.969876 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:41:08.976097 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491d9ecd0>]}
[0m23:41:08.986753 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:41:08.987410 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.06s]
[0m23:41:08.988043 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:41:08.988697 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:41:08.989131 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:41:08.990152 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:41:08.990616 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:41:08.990957 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:41:08.970125 => 2023-01-31 23:41:08.990871
[0m23:41:08.995792 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:41:08.996320 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:41:09.016353 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:41:08.991175 => 2023-01-31 23:41:09.016241
[0m23:41:09.027376 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:41:09.079834 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:09.086860 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:41:09.087287 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:41:09.089638 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:41:09.091850 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:41:09.092309 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:41:09.093359 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491d946a0>]}
[0m23:41:09.093948 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:41:09.095033 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.18s]
[0m23:41:09.096523 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:41:09.099464 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:41:09.100206 [info ] [Thread-2  ]: 6 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:41:09.101475 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:41:09.102172 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:41:09.106729 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:41:09.108275 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:41:09.102882 => 2023-01-31 23:41:09.108061
[0m23:41:09.108755 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:41:09.113757 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:41:09.115281 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:41:09.115633 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:41:09.115897 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:41:10.590276 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:41:10.604165 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:10.604534 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:41:10.840919 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:41:10.847607 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:10.847946 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:41:10.991307 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:41:11.014368 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:11.014728 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:41:11.058007 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:41:11.069883 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:41:09.033398 => 2023-01-31 23:41:11.069809
[0m23:41:11.070260 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:41:11.164952 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:41:11.170986 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:11.171320 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:41:11.203751 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:41:11.209086 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:41:09.109045 => 2023-01-31 23:41:11.209003
[0m23:41:11.209442 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:41:11.322001 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:41:11.323799 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491e28250>]}
[0m23:41:11.338745 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:41:11.339434 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.33s]
[0m23:41:11.368891 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:41:11.369377 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:41:11.371710 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:11.372049 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:41:11.482487 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb492108070>]}
[0m23:41:11.483269 [info ] [Thread-2  ]: 6 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.38s]
[0m23:41:11.483916 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:41:11.484760 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m23:41:11.485269 [info ] [Thread-1  ]: 7 of 7 START sql view model dev.dim_listings_w_hosts ........................... [RUN]
[0m23:41:11.486113 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m23:41:11.486437 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m23:41:11.490402 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:41:11.491232 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-01-31 23:41:11.486651 => 2023-01-31 23:41:11.491126
[0m23:41:11.491804 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m23:41:11.498520 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:41:11.500207 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m23:41:11.500488 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace   view airbnb.dev.dim_listings_w_hosts
  
   as (
    with
l as (select
*
from 
airbnb.dev.dim_listings_cleansed),
h as (
    select *
    fromairbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at,h.updated_at) as updated_at
FROM l
left join h on (h.host_id=l.host_id)
  );
[0m23:41:11.500742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:41:11.538568 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:41:11.539567 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:11.540142 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:41:12.123191 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1 seconds
[0m23:41:12.124460 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:12.125045 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:41:12.372706 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:41:12.384910 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:41:12.385288 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:41:12.558262 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:41:12.563171 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:41:08.996856 => 2023-01-31 23:41:12.563084
[0m23:41:12.563569 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: Close
[0m23:41:12.714610 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01aa070d-0000-f290-0000-00037126818d
[0m23:41:12.715261 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 4 unexpected 'fromairbnb'.
syntax error line 14 at position 0 unexpected 'select'.
[0m23:41:12.716066 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-01-31 23:41:11.492323 => 2023-01-31 23:41:12.715925
[0m23:41:12.716621 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m23:41:12.836754 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491d41b20>]}
[0m23:41:12.837557 [info ] [Thread-4  ]: 4 of 7 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.87s]
[0m23:41:12.838336 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:41:12.980071 [debug] [Thread-1  ]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 4 unexpected 'fromairbnb'.
  syntax error line 14 at position 0 unexpected 'select'.
  compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m23:41:12.981107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '363b9f6b-38ab-4952-8a14-9fa38752f2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49214eb20>]}
[0m23:41:12.982155 [error] [Thread-1  ]: 7 of 7 ERROR creating sql view model dev.dim_listings_w_hosts .................. [[31mERROR[0m in 1.50s]
[0m23:41:12.982944 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m23:41:12.985335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:41:12.986125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:12.986393 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m23:41:12.986618 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:41:12.986831 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:41:12.987042 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:41:12.987359 [info ] [MainThread]: 
[0m23:41:12.987788 [info ] [MainThread]: Finished running 4 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 11.32 seconds (11.32s).
[0m23:41:12.988650 [debug] [MainThread]: Command end result
[0m23:41:12.999499 [info ] [MainThread]: 
[0m23:41:13.000107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:41:13.000500 [info ] [MainThread]: 
[0m23:41:13.001206 [error] [MainThread]: [33mDatabase Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)[0m
[0m23:41:13.001680 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m23:41:13.002034 [error] [MainThread]:   syntax error line 11 at position 4 unexpected 'fromairbnb'.
[0m23:41:13.002371 [error] [MainThread]:   syntax error line 14 at position 0 unexpected 'select'.
[0m23:41:13.002710 [error] [MainThread]:   compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m23:41:13.003075 [info ] [MainThread]: 
[0m23:41:13.003446 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:41:13.003913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491aabdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49206bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491e1cb80>]}
[0m23:41:13.004301 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:48:39.515211 | 3802dcf4-dbac-4fbe-8b94-a0e0a539f088 ==============================
[0m23:48:39.515211 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:48:39.524623 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:48:39.525341 [debug] [MainThread]: Tracking: tracking
[0m23:48:39.526056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0940100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0940df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0940d00>]}
[0m23:48:39.658468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:48:39.658856 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:48:39.670129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc098d0d0>]}
[0m23:48:39.680113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0a26ca0>]}
[0m23:48:39.680769 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:48:39.681235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0a26d30>]}
[0m23:48:39.683268 [info ] [MainThread]: 
[0m23:48:39.685502 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:39.687907 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:48:39.710450 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:48:39.711020 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:48:39.711519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:47.303038 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 8 seconds
[0m23:48:47.305550 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:48:47.637500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:48:47.648489 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:48:47.649759 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:48:47.650290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:48.983008 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m23:48:48.985359 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:48:49.243390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0cccdc0>]}
[0m23:48:49.244357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:49.245004 [info ] [MainThread]: 
[0m23:48:49.252922 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:48:49.253412 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:48:49.253875 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:48:49.254441 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:48:49.256018 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m23:48:49.256672 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m23:48:49.257683 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:48:49.258415 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:48:49.259140 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:48:49.259535 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:48:49.259903 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:48:49.260262 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:48:49.262424 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:48:49.265012 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:48:49.267151 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:48:49.268584 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:48:49.260531 => 2023-01-31 23:48:49.268357
[0m23:48:49.269021 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:48:49.281553 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:48:49.262782 => 2023-01-31 23:48:49.281445
[0m23:48:49.288372 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:48:49.294210 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:48:49.265443 => 2023-01-31 23:48:49.293989
[0m23:48:49.317758 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:48:49.344320 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:48:49.351313 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:48:49.352062 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:48:49.356631 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:48:49.357139 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:48:49.357579 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:48:49.361050 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:48:49.361404 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:48:49.361665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:48:49.354234 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:48:49.366150 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:48:49.366542 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:48:50.936202 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:48:50.965016 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:48:49.329685 => 2023-01-31 23:48:50.964920
[0m23:48:50.965489 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:48:51.074110 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:48:51.082337 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:48:51.081822 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:48:49.269258 => 2023-01-31 23:48:51.081730
[0m23:48:51.087183 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:48:49.299848 => 2023-01-31 23:48:51.087112
[0m23:48:51.087999 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:48:51.088626 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:48:51.220661 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0fbca60>]}
[0m23:48:51.221472 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.96s]
[0m23:48:51.224698 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:48:51.225829 [debug] [Thread-4  ]: Began running node model.dbtlearn.fact_reviews
[0m23:48:51.226303 [info ] [Thread-4  ]: 4 of 7 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:48:51.227419 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:48:51.227856 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:48:51.242950 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:48:51.245613 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:48:51.228079 => 2023-01-31 23:48:51.245213
[0m23:48:51.246061 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:48:51.314438 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:51.314855 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:48:51.315160 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:48:51.345757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0fab6a0>]}
[0m23:48:51.346917 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0eff700>]}
[0m23:48:51.347559 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.09s]
[0m23:48:51.348010 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.09s]
[0m23:48:51.349074 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:48:51.349518 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:48:51.350581 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:48:51.351240 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:48:51.351790 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:48:51.352483 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:48:51.352899 [info ] [Thread-1  ]: 6 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:48:51.353439 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:48:51.354232 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:48:51.358517 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:48:51.358981 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:48:51.363009 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:48:51.363756 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:48:51.354491 => 2023-01-31 23:48:51.363663
[0m23:48:51.364157 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:48:51.400383 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:48:51.400793 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:48:51.359333 => 2023-01-31 23:48:51.400702
[0m23:48:51.401329 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:48:51.405252 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:48:51.407025 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:48:51.408306 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:48:51.408597 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:48:51.408882 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:48:51.409142 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:48:51.409397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:48:52.557350 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:48:52.569699 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:52.570112 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:48:52.711697 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:48:52.718722 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:52.719061 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:48:52.850350 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:48:52.877197 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:52.877562 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:48:53.027872 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:48:53.035505 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:53.035852 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:48:53.182479 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:48:53.206797 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:48:53.234987 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:48:53.235695 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:48:53.246364 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:48:51.401569 => 2023-01-31 23:48:53.246290
[0m23:48:53.246870 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:48:53.248915 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:53.249410 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:48:53.421733 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:48:53.422483 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:53.422981 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:48:53.488900 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:48:53.494433 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:48:51.364476 => 2023-01-31 23:48:53.494333
[0m23:48:53.494785 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:48:53.535033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0ff2670>]}
[0m23:48:53.535830 [info ] [Thread-1  ]: 6 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.18s]
[0m23:48:53.536576 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:48:53.730941 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0 seconds
[0m23:48:53.731773 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:53.732286 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:48:53.800983 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0fb6610>]}
[0m23:48:53.801785 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.45s]
[0m23:48:53.802432 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:48:53.803134 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m23:48:53.803543 [info ] [Thread-2  ]: 7 of 7 START sql view model dev.dim_listings_w_hosts ........................... [RUN]
[0m23:48:53.804457 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m23:48:53.804777 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m23:48:53.809568 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:48:53.812143 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-01-31 23:48:53.805044 => 2023-01-31 23:48:53.811991
[0m23:48:53.812667 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m23:48:53.817949 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:48:53.819615 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m23:48:53.819889 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace   view airbnb.dev.dim_listings_w_hosts
  
   as (
    with
l as (select
*
from 
airbnb.dev.dim_listings_cleansed),
h as (
    select *
    fromairbnb.dev.dim_hosts_cleansed
)

select
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at,h.updated_at) as updated_at
FROM l
left join h on (h.host_id=l.host_id)
  );
[0m23:48:53.820229 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:48:53.951738 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:48:53.963556 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:48:53.963919 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:48:54.132533 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:48:54.137920 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:48:51.246290 => 2023-01-31 23:48:54.137829
[0m23:48:54.138345 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: Close
[0m23:48:54.452739 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc10502e0>]}
[0m23:48:54.453727 [info ] [Thread-4  ]: 4 of 7 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.23s]
[0m23:48:54.455346 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:48:54.863720 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01aa0714-0000-f290-0000-0003712681ad
[0m23:48:54.864184 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 4 unexpected 'fromairbnb'.
syntax error line 14 at position 0 unexpected 'select'.
[0m23:48:54.864732 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-01-31 23:48:53.813071 => 2023-01-31 23:48:54.864630
[0m23:48:54.865102 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m23:48:55.190975 [debug] [Thread-2  ]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 4 unexpected 'fromairbnb'.
  syntax error line 14 at position 0 unexpected 'select'.
  compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m23:48:55.191686 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3802dcf4-dbac-4fbe-8b94-a0e0a539f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc1065160>]}
[0m23:48:55.192374 [error] [Thread-2  ]: 7 of 7 ERROR creating sql view model dev.dim_listings_w_hosts .................. [[31mERROR[0m in 1.39s]
[0m23:48:55.192965 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m23:48:55.195727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:55.196476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:55.196901 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:48:55.197372 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m23:48:55.197757 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:48:55.198115 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:48:55.198695 [info ] [MainThread]: 
[0m23:48:55.199304 [info ] [MainThread]: Finished running 4 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 15.51 seconds (15.51s).
[0m23:48:55.200209 [debug] [MainThread]: Command end result
[0m23:48:55.211984 [info ] [MainThread]: 
[0m23:48:55.212716 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:48:55.213217 [info ] [MainThread]: 
[0m23:48:55.213787 [error] [MainThread]: [33mDatabase Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)[0m
[0m23:48:55.214241 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m23:48:55.214651 [error] [MainThread]:   syntax error line 11 at position 4 unexpected 'fromairbnb'.
[0m23:48:55.215069 [error] [MainThread]:   syntax error line 14 at position 0 unexpected 'select'.
[0m23:48:55.215500 [error] [MainThread]:   compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m23:48:55.215927 [info ] [MainThread]: 
[0m23:48:55.216389 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m23:48:55.217015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0a268e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc0b1e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcc10d76a0>]}
[0m23:48:55.217683 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:50:54.399848 | bd721845-de9f-4f65-b458-57c4facbcffd ==============================
[0m23:50:54.399848 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:50:54.403672 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:50:54.404137 [debug] [MainThread]: Tracking: tracking
[0m23:50:54.404710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a17f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a17fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a17fd00>]}
[0m23:50:54.508786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:54.509474 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_w_hosts.sql
[0m23:50:54.538742 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m23:50:54.579316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a32e0d0>]}
[0m23:50:54.588823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a2dffa0>]}
[0m23:50:54.589373 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:50:54.589871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a2dbf70>]}
[0m23:50:54.591849 [info ] [MainThread]: 
[0m23:50:54.594093 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:50:54.595951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:50:54.617063 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:50:54.617486 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:50:54.617822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:02.354412 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 8 seconds
[0m23:51:02.356748 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:51:02.637708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:51:02.647517 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:51:02.647912 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:51:02.648210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:03.631848 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1 seconds
[0m23:51:03.635029 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:51:03.897438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a2dfdf0>]}
[0m23:51:03.898423 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:03.898887 [info ] [MainThread]: 
[0m23:51:03.906607 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:51:03.907083 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:51:03.907422 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:51:03.907814 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:51:03.908423 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m23:51:03.908980 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m23:51:03.909864 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:51:03.910554 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:51:03.911229 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:51:03.911579 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:51:03.911891 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:51:03.912217 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:51:03.914442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:51:03.917255 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:51:03.919955 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:51:03.920978 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:51:03.914822 => 2023-01-31 23:51:03.920864
[0m23:51:03.921330 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:51:03.912466 => 2023-01-31 23:51:03.921257
[0m23:51:03.921576 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:51:03.918000 => 2023-01-31 23:51:03.921518
[0m23:51:03.921875 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:51:03.922234 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:51:03.922577 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:51:04.010263 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:51:04.015222 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:51:04.015958 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:51:04.017369 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:51:04.017810 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:51:04.018790 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:51:04.019134 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:51:04.020010 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:51:04.020245 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:51:04.022137 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:51:04.022555 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:51:04.022929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:51:05.549871 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:51:05.578575 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:51:03.922832 => 2023-01-31 23:51:05.578496
[0m23:51:05.578951 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:51:05.729926 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:51:05.735057 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:51:03.958118 => 2023-01-31 23:51:05.734972
[0m23:51:05.736347 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:51:05.736633 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:51:05.740791 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:51:03.939274 => 2023-01-31 23:51:05.740713
[0m23:51:05.742367 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:51:05.842993 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a712b50>]}
[0m23:51:05.843988 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.93s]
[0m23:51:05.848503 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:51:05.852010 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:51:05.852801 [info ] [Thread-4  ]: 4 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:51:05.855312 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:51:05.856012 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:51:05.859982 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:51:05.861266 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:51:05.856603 => 2023-01-31 23:51:05.861155
[0m23:51:05.861660 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:51:05.900016 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:51:05.901943 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:51:05.902300 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:51:05.902562 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:51:05.987590 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a7e94f0>]}
[0m23:51:05.988510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a7d3460>]}
[0m23:51:05.989212 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.08s]
[0m23:51:05.990405 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:51:05.989954 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.08s]
[0m23:51:05.991660 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:51:05.992182 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:51:05.992723 [debug] [Thread-1  ]: Began running node model.dbtlearn.fact_reviews
[0m23:51:05.993141 [info ] [Thread-2  ]: 5 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:51:05.993725 [info ] [Thread-1  ]: 6 of 7 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:51:05.994662 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:51:05.995337 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:51:05.995663 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:51:05.996073 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:51:06.000597 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:51:06.014351 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:51:05.996331 => 2023-01-31 23:51:06.014237
[0m23:51:06.014757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:51:06.015226 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:51:06.020207 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:51:06.021543 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:51:06.000962 => 2023-01-31 23:51:06.021442
[0m23:51:06.021968 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:51:06.022965 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:51:06.041498 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:51:06.057381 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:51:06.079611 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:06.080176 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:51:06.080615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:51:07.508904 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:51:07.520497 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:51:05.861877 => 2023-01-31 23:51:07.520416
[0m23:51:07.520891 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:51:07.638880 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:51:07.651156 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:07.651528 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:51:07.774797 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a8303d0>]}
[0m23:51:07.775583 [info ] [Thread-4  ]: 4 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.92s]
[0m23:51:07.776374 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:51:07.806736 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:51:07.812429 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:07.812781 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:51:07.941794 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:51:07.947607 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:51:06.015732 => 2023-01-31 23:51:07.947536
[0m23:51:07.947947 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:51:08.000330 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:51:08.022811 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:08.023163 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:51:08.171710 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:51:08.177695 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:08.178015 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:51:08.185382 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a70f130>]}
[0m23:51:08.186070 [info ] [Thread-2  ]: 5 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.19s]
[0m23:51:08.186658 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:51:08.187523 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m23:51:08.188329 [info ] [Thread-3  ]: 7 of 7 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m23:51:08.189344 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m23:51:08.189682 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m23:51:08.193665 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:51:08.194355 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-01-31 23:51:08.189895 => 2023-01-31 23:51:08.194271
[0m23:51:08.194682 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m23:51:08.199700 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:51:08.201287 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m23:51:08.201563 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH l AS ( SELECT * FROM airbnb.dev.dim_listings_cleansed ), 
h AS ( SELECT * FROM airbnb.dev.dim_hosts_cleansed )
SELECT l.listing_id, l.listing_name, l.room_type, l.minimum_nights, l.price, l.host_id, h.host_name, h.is_superhost as host_is_superhost, l.created_at, GREATEST(l.updated_at, h.updated_at) as updated_at FROM l LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m23:51:08.201820 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:51:08.325062 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:51:08.339481 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:51:08.364952 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:51:08.366165 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:08.366494 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:51:08.544817 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:51:08.545586 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:08.545964 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:51:08.950143 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0 seconds
[0m23:51:08.950974 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:08.951470 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:51:09.207309 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:51:09.219146 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:51:09.219501 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:51:09.387116 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:51:09.392120 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:51:06.023183 => 2023-01-31 23:51:09.392032
[0m23:51:09.392516 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: Close
[0m23:51:09.652701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a7d3430>]}
[0m23:51:09.653504 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.66s]
[0m23:51:09.654272 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:51:10.197078 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:51:10.202030 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-01-31 23:51:08.194890 => 2023-01-31 23:51:10.201944
[0m23:51:10.202425 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m23:51:10.454932 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd721845-de9f-4f65-b458-57c4facbcffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a837910>]}
[0m23:51:10.455721 [info ] [Thread-3  ]: 7 of 7 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.27s]
[0m23:51:10.456558 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m23:51:10.459812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:51:10.460601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:10.460913 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:51:10.461173 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:51:10.461425 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m23:51:10.461662 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:51:10.462001 [info ] [MainThread]: 
[0m23:51:10.462390 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 15.87 seconds (15.87s).
[0m23:51:10.463183 [debug] [MainThread]: Command end result
[0m23:51:10.471709 [info ] [MainThread]: 
[0m23:51:10.472265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:10.472757 [info ] [MainThread]: 
[0m23:51:10.473173 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:51:10.473737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a2dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a68c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe50a68ca90>]}
[0m23:51:10.474124 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:54:58.916754 | aea1adca-d429-4d1a-b7bd-b0db06e22464 ==============================
[0m23:54:58.916754 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:54:58.928232 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:54:58.928684 [debug] [MainThread]: Tracking: tracking
[0m23:54:58.929304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5b9bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5b9bddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5b9bdd00>]}
[0m23:54:59.039979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:59.040370 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:59.051476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5ba0e0d0>]}
[0m23:54:59.062892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5baaac10>]}
[0m23:54:59.063458 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:54:59.063975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5baaaca0>]}
[0m23:54:59.065987 [info ] [MainThread]: 
[0m23:54:59.068290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:59.070152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:54:59.093639 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:54:59.094049 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:54:59.094371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:00.677765 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:55:00.681140 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:55:00.951873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:55:00.961809 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:55:00.962210 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:55:00.962517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:01.934466 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1 seconds
[0m23:55:01.937798 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:55:02.212538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5bba02b0>]}
[0m23:55:02.213509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:55:02.213942 [info ] [MainThread]: 
[0m23:55:02.222118 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:55:02.222584 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:55:02.222914 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:55:02.223302 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:55:02.223977 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m23:55:02.224601 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m23:55:02.225637 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:55:02.226453 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:55:02.227142 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:55:02.227541 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:55:02.228132 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:55:02.228735 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:55:02.231073 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:55:02.233572 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:55:02.235839 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:55:02.236867 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:55:02.231353 => 2023-01-31 23:55:02.236759
[0m23:55:02.237277 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:55:02.229149 => 2023-01-31 23:55:02.237190
[0m23:55:02.237570 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:55:02.233976 => 2023-01-31 23:55:02.237497
[0m23:55:02.237898 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:55:02.238257 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:55:02.238923 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:55:02.333974 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:55:02.335814 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:55:02.337973 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:55:02.339499 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:55:02.339801 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:55:02.340063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:55:02.342646 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:55:02.343047 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:55:02.344111 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:55:02.344372 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:55:02.344902 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:55:02.347778 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:55:04.076628 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:55:04.103823 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:55:04.106974 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:55:02.239267 => 2023-01-31 23:55:04.106900
[0m23:55:04.110128 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:55:02.270037 => 2023-01-31 23:55:04.110064
[0m23:55:04.110513 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:55:04.110800 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:55:04.174720 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:55:04.180424 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:55:02.252598 => 2023-01-31 23:55:04.180336
[0m23:55:04.180789 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:55:04.396390 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5bf246d0>]}
[0m23:55:04.397811 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.17s]
[0m23:55:04.402517 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:55:04.403489 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5be56880>]}
[0m23:55:04.404430 [debug] [Thread-4  ]: Began running node model.dbtlearn.fact_reviews
[0m23:55:04.405135 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.18s]
[0m23:55:04.406039 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:55:04.405517 [info ] [Thread-4  ]: 4 of 7 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:55:04.407147 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:55:04.407480 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:55:04.422012 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:55:04.422593 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:55:04.423298 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:55:04.424655 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:55:04.425008 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:55:04.407701 => 2023-01-31 23:55:04.424921
[0m23:55:04.425306 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:55:04.425674 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:55:04.429104 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:55:04.462944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5bfdf6a0>]}
[0m23:55:04.474924 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.24s]
[0m23:55:04.475444 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:55:04.425924 => 2023-01-31 23:55:04.475350
[0m23:55:04.491984 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:04.492498 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:55:04.493144 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:55:04.493450 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:55:04.512773 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:55:04.513071 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:55:04.527869 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:55:04.528326 [info ] [Thread-2  ]: 6 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:55:04.531071 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:55:04.531475 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:55:04.535764 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:55:04.537531 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:55:04.538265 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:55:04.539123 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:55:04.542558 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:55:04.531715 => 2023-01-31 23:55:04.542428
[0m23:55:04.543296 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:55:04.549265 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:55:04.551972 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:55:04.552495 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:55:04.552882 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:55:06.125459 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:55:06.143570 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:06.144111 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:55:06.301953 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:55:06.308573 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:06.309004 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:55:06.453174 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:55:06.476059 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:06.476643 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:55:06.485806 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:55:06.495693 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:55:04.543764 => 2023-01-31 23:55:06.495615
[0m23:55:06.496068 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:55:06.597922 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:55:06.603513 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:55:04.494088 => 2023-01-31 23:55:06.603440
[0m23:55:06.603890 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:55:06.613460 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:55:06.618678 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:06.619037 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:55:06.759736 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5c8c8040>]}
[0m23:55:06.762329 [info ] [Thread-2  ]: 6 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.23s]
[0m23:55:06.763757 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:55:06.765885 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:55:06.782509 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:55:06.808032 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:55:06.810273 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:06.810646 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:55:06.873140 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5c86b7f0>]}
[0m23:55:06.874131 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.45s]
[0m23:55:06.875104 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:55:06.908824 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m23:55:06.909613 [info ] [Thread-1  ]: 7 of 7 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m23:55:06.910953 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m23:55:06.911520 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m23:55:06.924296 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:55:06.925402 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-01-31 23:55:06.911929 => 2023-01-31 23:55:06.925279
[0m23:55:06.925950 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m23:55:06.933424 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:55:06.943705 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m23:55:06.944242 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH l AS ( SELECT * FROM airbnb.dev.dim_listings_cleansed ), 
h AS ( SELECT * FROM airbnb.dev.dim_hosts_cleansed )
SELECT l.listing_id, l.listing_name, l.room_type, l.minimum_nights, l.price, l.host_id, h.host_name, h.is_superhost as host_is_superhost, l.created_at, GREATEST(l.updated_at, h.updated_at) as updated_at FROM l LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m23:55:06.944654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:55:06.985820 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:55:06.986737 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:06.987337 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:55:07.293344 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0 seconds
[0m23:55:07.294225 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:07.294861 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:55:07.510432 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:55:07.531764 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:55:07.537303 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:55:07.749639 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:55:07.753207 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:55:04.429389 => 2023-01-31 23:55:07.753055
[0m23:55:07.753788 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: Close
[0m23:55:08.031217 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5bef6130>]}
[0m23:55:08.032028 [info ] [Thread-4  ]: 4 of 7 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.62s]
[0m23:55:08.032830 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:55:09.204879 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:55:09.210036 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-01-31 23:55:06.926313 => 2023-01-31 23:55:09.209967
[0m23:55:09.210381 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m23:55:09.482000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea1adca-d429-4d1a-b7bd-b0db06e22464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5c8a5820>]}
[0m23:55:09.482785 [info ] [Thread-1  ]: 7 of 7 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.57s]
[0m23:55:09.483594 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m23:55:09.487014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:55:09.488039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:09.488395 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m23:55:09.488699 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:55:09.489159 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:55:09.490411 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:55:09.491088 [info ] [MainThread]: 
[0m23:55:09.491540 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 10.42 seconds (10.42s).
[0m23:55:09.492467 [debug] [MainThread]: Command end result
[0m23:55:09.512549 [info ] [MainThread]: 
[0m23:55:09.513093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:55:09.513589 [info ] [MainThread]: 
[0m23:55:09.514054 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:55:09.514529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5baaa850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5c985a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b5c985310>]}
[0m23:55:09.514903 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:57:13.258975 | 6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72 ==============================
[0m23:57:13.258975 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:57:13.263160 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:57:13.263814 [debug] [MainThread]: Tracking: tracking
[0m23:57:13.265207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835913d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835913ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835913dd00>]}
[0m23:57:13.368732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:13.369145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:13.379421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835918f0d0>]}
[0m23:57:13.389569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8359361ca0>]}
[0m23:57:13.390150 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:57:13.390624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8359361d30>]}
[0m23:57:13.392563 [info ] [MainThread]: 
[0m23:57:13.394766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:13.396433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:57:13.419901 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:57:13.420308 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:57:13.420622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:21.142796 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 8 seconds
[0m23:57:21.146243 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:57:21.501092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:57:21.512157 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:57:21.512771 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:57:21.513185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:23.206943 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m23:57:23.210631 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:57:23.492914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835944beb0>]}
[0m23:57:23.493961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:23.494500 [info ] [MainThread]: 
[0m23:57:23.501939 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:57:23.502406 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:57:23.502734 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:57:23.503136 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:57:23.503863 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m23:57:23.504512 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m23:57:23.505596 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:57:23.506401 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:57:23.507621 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:57:23.508269 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:57:23.508609 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:57:23.508906 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:57:23.511128 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:57:23.513546 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:57:23.515776 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:57:23.516696 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:57:23.509157 => 2023-01-31 23:57:23.516585
[0m23:57:23.517068 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:57:23.511476 => 2023-01-31 23:57:23.516985
[0m23:57:23.517426 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:57:23.517854 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:57:23.524548 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:57:23.513953 => 2023-01-31 23:57:23.524440
[0m23:57:23.561128 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:57:23.600513 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:57:23.603175 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:57:23.607739 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:57:23.609305 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:57:23.610285 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:57:23.610528 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:57:23.611276 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:57:23.611752 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:57:23.612129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:57:23.612673 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:57:23.612978 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:57:23.614859 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:57:25.240360 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:57:25.265591 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:57:23.585029 => 2023-01-31 23:57:25.265516
[0m23:57:25.265967 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:57:25.289765 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:57:25.293800 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:57:23.524898 => 2023-01-31 23:57:25.293716
[0m23:57:25.294202 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:57:25.408536 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:57:25.412956 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:57:23.518123 => 2023-01-31 23:57:25.412874
[0m23:57:25.413350 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:57:25.518431 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8359698a00>]}
[0m23:57:25.519332 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.01s]
[0m23:57:25.523497 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:57:25.525259 [debug] [Thread-4  ]: Began running node model.dbtlearn.fact_reviews
[0m23:57:25.525937 [info ] [Thread-4  ]: 4 of 7 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:57:25.527367 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:57:25.528074 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:57:25.550243 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:57:25.551152 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:57:25.528614 => 2023-01-31 23:57:25.551043
[0m23:57:25.551725 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:57:25.573610 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835979a460>]}
[0m23:57:25.589583 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.07s]
[0m23:57:25.618889 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:25.619421 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:57:25.619742 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:57:25.620499 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:57:25.620746 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:57:25.621164 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:57:25.624030 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:57:25.624543 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:57:25.629274 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:57:25.630416 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:57:25.624860 => 2023-01-31 23:57:25.630164
[0m23:57:25.631005 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:57:25.670997 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:57:25.672814 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:57:25.673130 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:57:25.673383 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:57:25.697879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83597924c0>]}
[0m23:57:25.698671 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.19s]
[0m23:57:25.699367 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:57:25.700207 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:57:25.700778 [info ] [Thread-2  ]: 6 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:57:25.701710 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:57:25.702069 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:57:25.706048 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:57:25.706824 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:57:25.702291 => 2023-01-31 23:57:25.706733
[0m23:57:25.707233 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:57:25.711698 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:57:25.713024 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:57:25.713310 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:57:25.713562 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:57:27.106045 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:57:27.124725 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:27.125111 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:57:27.283223 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:57:27.289920 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:27.291088 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:57:27.432585 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:57:27.457404 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:27.457776 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:57:27.605352 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:57:27.610458 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:27.610796 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:57:27.758061 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:57:27.776140 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:57:27.789011 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:57:27.812298 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:57:27.818563 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:57:27.825632 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:57:25.632008 => 2023-01-31 23:57:27.825555
[0m23:57:27.835803 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:27.837132 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:57:25.707456 => 2023-01-31 23:57:27.836967
[0m23:57:27.838360 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:57:27.838963 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:57:27.839488 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:57:28.005691 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:57:28.006357 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:28.006714 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:57:28.093935 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835a230340>]}
[0m23:57:28.094727 [info ] [Thread-2  ]: 6 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.39s]
[0m23:57:28.095504 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:57:28.106010 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83597924c0>]}
[0m23:57:28.106626 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.48s]
[0m23:57:28.107208 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:57:28.107948 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m23:57:28.108366 [info ] [Thread-1  ]: 7 of 7 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m23:57:28.109335 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m23:57:28.109801 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m23:57:28.114794 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:57:28.115526 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-01-31 23:57:28.110043 => 2023-01-31 23:57:28.115440
[0m23:57:28.115859 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m23:57:28.119670 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:57:28.121291 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m23:57:28.121571 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH l AS ( SELECT * FROM airbnb.dev.dim_listings_cleansed ), 
h AS ( SELECT * FROM airbnb.dev.dim_hosts_cleansed )
SELECT l.listing_id, l.listing_name, l.room_type, l.minimum_nights, l.price, l.host_id, h.host_name, h.is_superhost as host_is_superhost, l.created_at, GREATEST(l.updated_at, h.updated_at) as updated_at FROM l LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m23:57:28.121819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:57:28.312588 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0 seconds
[0m23:57:28.313155 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:28.313404 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:57:28.530557 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:57:28.560534 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:57:28.560973 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:57:28.771955 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:57:28.775535 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:57:25.552002 => 2023-01-31 23:57:28.775461
[0m23:57:28.775892 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: Close
[0m23:57:29.033594 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835963b190>]}
[0m23:57:29.034446 [info ] [Thread-4  ]: 4 of 7 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.51s]
[0m23:57:29.035078 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:57:29.936278 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:57:29.942116 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-01-31 23:57:28.116070 => 2023-01-31 23:57:29.942041
[0m23:57:29.942483 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m23:57:30.198614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bf0b4-9a0e-4467-b9a3-50c0d6882a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8359640190>]}
[0m23:57:30.199433 [info ] [Thread-1  ]: 7 of 7 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.09s]
[0m23:57:30.201800 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m23:57:30.204518 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:30.205656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:30.206037 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m23:57:30.206394 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:57:30.206830 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:57:30.207193 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:57:30.207595 [info ] [MainThread]: 
[0m23:57:30.208290 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 16.81 seconds (16.81s).
[0m23:57:30.209196 [debug] [MainThread]: Command end result
[0m23:57:30.225877 [info ] [MainThread]: 
[0m23:57:30.226867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:30.229815 [info ] [MainThread]: 
[0m23:57:30.230334 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:57:30.230831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83593618e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835979d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835979b700>]}
[0m23:57:30.231216 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 23:58:18.780117 | 07292bef-5150-40a1-8957-fae05c2a71b5 ==============================
[0m23:58:18.780117 [info ] [MainThread]: Running with dbt=1.4.1
[0m23:58:18.783849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:58:18.784558 [debug] [MainThread]: Tracking: tracking
[0m23:58:18.785750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d21bf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d21bfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d21bfd00>]}
[0m23:58:18.889936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:18.890326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:18.900691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d22100d0>]}
[0m23:58:18.910091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d22abcd0>]}
[0m23:58:18.910634 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m23:58:18.911060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d22abd60>]}
[0m23:58:18.912931 [info ] [MainThread]: 
[0m23:58:18.915041 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:58:18.916710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m23:58:18.940169 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m23:58:18.940586 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m23:58:18.941028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:28.213709 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 9 seconds
[0m23:58:28.216845 [debug] [ThreadPool]: On list_airbnb: Close
[0m23:58:28.475428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m23:58:28.485159 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m23:58:28.485547 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m23:58:28.485832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:29.643956 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1 seconds
[0m23:58:29.647318 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m23:58:29.896247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2227ac0>]}
[0m23:58:29.897263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:58:29.897700 [info ] [MainThread]: 
[0m23:58:29.905233 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m23:58:29.905759 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m23:58:29.906313 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m23:58:29.906634 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m23:58:29.907321 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m23:58:29.907850 [info ] [Thread-2  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m23:58:29.908415 [info ] [Thread-3  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m23:58:29.908923 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m23:58:29.909637 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m23:58:29.910383 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m23:58:29.912735 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m23:58:29.913260 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m23:58:29.913725 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m23:58:29.917316 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m23:58:29.919547 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m23:58:29.920209 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-01-31 23:58:29.910688 => 2023-01-31 23:58:29.920057
[0m23:58:29.920626 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m23:58:29.931489 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-01-31 23:58:29.917772 => 2023-01-31 23:58:29.931378
[0m23:58:29.931951 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-01-31 23:58:29.914408 => 2023-01-31 23:58:29.931782
[0m23:58:29.932285 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m23:58:29.949284 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m23:58:29.974034 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m23:58:29.980015 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m23:58:29.984942 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m23:58:29.986440 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m23:58:29.986738 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
  );
[0m23:58:29.986999 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:58:29.989739 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m23:58:29.990928 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m23:58:29.992309 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m23:58:29.991570 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m23:58:29.993269 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:58:29.992721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:58:31.411575 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:58:31.436872 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-01-31 23:58:29.968451 => 2023-01-31 23:58:31.436795
[0m23:58:31.437244 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m23:58:31.568090 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:58:31.572904 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-01-31 23:58:29.980349 => 2023-01-31 23:58:31.572817
[0m23:58:31.574279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:58:31.574628 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m23:58:31.577336 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-01-31 23:58:29.920886 => 2023-01-31 23:58:31.577273
[0m23:58:31.578684 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m23:58:31.685054 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d274b610>]}
[0m23:58:31.687158 [info ] [Thread-3  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 1.77s]
[0m23:58:31.691950 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m23:58:31.694358 [debug] [Thread-4  ]: Began running node model.dbtlearn.fact_reviews
[0m23:58:31.694960 [info ] [Thread-4  ]: 4 of 7 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m23:58:31.697519 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m23:58:31.698242 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fact_reviews
[0m23:58:31.713634 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m23:58:31.714901 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-01-31 23:58:31.698588 => 2023-01-31 23:58:31.714798
[0m23:58:31.715280 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fact_reviews
[0m23:58:31.768992 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:31.769390 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from airbnb.dev.src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m23:58:31.769656 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:58:31.853235 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d274bac0>]}
[0m23:58:31.854116 [info ] [Thread-2  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 1.94s]
[0m23:58:31.854811 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m23:58:31.855786 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m23:58:31.856509 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m23:58:31.858476 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m23:58:31.858934 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m23:58:31.863335 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m23:58:31.864317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d274bb80>]}
[0m23:58:31.865022 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 1.96s]
[0m23:58:31.865658 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m23:58:31.865986 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-01-31 23:58:31.859219 => 2023-01-31 23:58:31.865905
[0m23:58:31.866595 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m23:58:31.866932 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m23:58:31.867334 [info ] [Thread-2  ]: 6 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m23:58:31.893314 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m23:58:31.899568 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m23:58:31.904360 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m23:58:31.908180 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:58:31.910578 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m23:58:31.910951 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-01-31 23:58:31.904736 => 2023-01-31 23:58:31.910854
[0m23:58:31.911219 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With src_listings as (
    select * from airbnb.dev.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m23:58:31.911566 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m23:58:31.911860 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:58:31.915663 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m23:58:31.919551 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m23:58:31.920133 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With src_hosts as (
    select * from airbnb.dev.src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m23:58:31.920929 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:58:32.975469 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m23:58:32.989398 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:32.989812 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:58:33.147826 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:58:33.154126 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:33.154456 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m23:58:33.315326 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:58:33.337490 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:33.337851 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m23:58:33.500727 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:58:33.507177 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:33.507520 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m23:58:33.661745 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m23:58:33.677492 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:58:33.701522 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m23:58:33.705539 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:33.706206 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m23:58:33.871597 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:58:33.873689 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:33.874883 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:58:33.875348 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m23:58:33.891063 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-01-31 23:58:31.867732 => 2023-01-31 23:58:33.890987
[0m23:58:33.891849 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m23:58:34.030302 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:58:34.036256 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-01-31 23:58:31.912103 => 2023-01-31 23:58:34.036185
[0m23:58:34.036617 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m23:58:34.138594 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d26becd0>]}
[0m23:58:34.139485 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.28s]
[0m23:58:34.140356 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m23:58:34.197801 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0 seconds
[0m23:58:34.198638 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:34.199149 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m23:58:34.289791 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d26bb640>]}
[0m23:58:34.290462 [info ] [Thread-2  ]: 6 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.40s]
[0m23:58:34.291066 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m23:58:34.291853 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m23:58:34.292574 [info ] [Thread-1  ]: 7 of 7 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m23:58:34.293905 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m23:58:34.294314 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m23:58:34.298645 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:58:34.301478 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-01-31 23:58:34.294552 => 2023-01-31 23:58:34.301287
[0m23:58:34.301942 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m23:58:34.307756 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m23:58:34.309491 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m23:58:34.309778 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH l AS ( SELECT * FROM airbnb.dev.dim_listings_cleansed ), 
h AS ( SELECT * FROM airbnb.dev.dim_hosts_cleansed )
SELECT l.listing_id, l.listing_name, l.room_type, l.minimum_nights, l.price, l.host_id, h.host_name, h.is_superhost as host_is_superhost, l.created_at, GREATEST(l.updated_at, h.updated_at) as updated_at FROM l LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m23:58:34.310150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:58:34.438543 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:58:34.449084 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m23:58:34.449441 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m23:58:34.607770 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m23:58:34.612843 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-01-31 23:58:31.715501 => 2023-01-31 23:58:34.612759
[0m23:58:34.613252 [debug] [Thread-4  ]: On model.dbtlearn.fact_reviews: Close
[0m23:58:34.921949 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d2716700>]}
[0m23:58:34.923725 [info ] [Thread-4  ]: 4 of 7 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 3.22s]
[0m23:58:34.924513 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fact_reviews
[0m23:58:36.366275 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m23:58:36.374020 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-01-31 23:58:34.302175 => 2023-01-31 23:58:36.373934
[0m23:58:36.374405 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m23:58:36.624459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07292bef-5150-40a1-8957-fae05c2a71b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d26be370>]}
[0m23:58:36.625242 [info ] [Thread-1  ]: 7 of 7 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.33s]
[0m23:58:36.626180 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m23:58:36.628876 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:58:36.629632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:36.629909 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m23:58:36.630150 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m23:58:36.630393 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m23:58:36.630639 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m23:58:36.630994 [info ] [MainThread]: 
[0m23:58:36.631564 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 17.72 seconds (17.72s).
[0m23:58:36.632709 [debug] [MainThread]: Command end result
[0m23:58:36.641973 [info ] [MainThread]: 
[0m23:58:36.642491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:36.642887 [info ] [MainThread]: 
[0m23:58:36.643258 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:58:36.643718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d22ab910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d26ea5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7d26fe460>]}
[0m23:58:36.644096 [debug] [MainThread]: Flushing usage events


============================== 2023-02-01 00:01:01.993246 | 8de3c7d1-0b75-4639-82d4-4b44393b6bfa ==============================
[0m00:01:01.993246 [info ] [MainThread]: Running with dbt=1.4.1
[0m00:01:01.997276 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/ht1965/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m00:01:01.997999 [debug] [MainThread]: Tracking: tracking
[0m00:01:01.999476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a011bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a011bddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a011bdd00>]}
[0m00:01:02.035863 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:01:02.036496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a011bd6d0>]}
[0m00:01:03.106305 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m00:01:03.124016 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m00:01:03.128754 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m00:01:03.133006 [debug] [MainThread]: 1603: static parser failed on fct/fact_reviews.sql
[0m00:01:03.144934 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fact_reviews.sql
[0m00:01:03.146884 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m00:01:03.151083 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m00:01:03.155643 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m00:01:03.207740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0125e880>]}
[0m00:01:03.216721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a011bd9a0>]}
[0m00:01:03.217220 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m00:01:03.217683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a012003d0>]}
[0m00:01:03.220676 [info ] [MainThread]: 
[0m00:01:03.223040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:03.224618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m00:01:03.248283 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m00:01:03.248685 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m00:01:03.248986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:04.816195 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m00:01:04.819901 [debug] [ThreadPool]: On list_airbnb: Close
[0m00:01:06.284179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m00:01:06.293734 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m00:01:06.294120 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m00:01:06.294410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:08.277269 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m00:01:08.280786 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m00:01:08.895412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a012003d0>]}
[0m00:01:08.898254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:08.898837 [info ] [MainThread]: 
[0m00:01:08.908800 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m00:01:08.909594 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m00:01:08.910396 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m00:01:08.912725 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m00:01:08.913517 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m00:01:08.914217 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m00:01:08.914568 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m00:01:08.914882 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m00:01:08.915223 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m00:01:08.919301 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m00:01:08.921576 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m00:01:08.927731 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m00:01:08.929540 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-01 00:01:08.915490 => 2023-02-01 00:01:08.929358
[0m00:01:08.930060 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-01 00:01:08.919752 => 2023-02-01 00:01:08.929923
[0m00:01:08.932594 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m00:01:08.932899 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-01 00:01:08.921997 => 2023-02-01 00:01:08.932809
[0m00:01:08.935235 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m00:01:08.936246 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m00:01:08.936903 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m00:01:08.937457 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m00:01:08.938536 [debug] [Thread-1  ]: Began running node model.dbtlearn.fact_reviews
[0m00:01:08.938035 [info ] [Thread-2  ]: 1 of 4 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m00:01:08.939409 [info ] [Thread-3  ]: 2 of 4 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m00:01:08.940114 [info ] [Thread-1  ]: 3 of 4 START sql incremental model dev.fact_reviews ............................ [RUN]
[0m00:01:08.941683 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m00:01:08.944251 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m00:01:08.945023 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fact_reviews'
[0m00:01:08.945382 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m00:01:08.945688 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m00:01:08.945978 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fact_reviews
[0m00:01:08.956529 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m00:01:08.978712 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m00:01:08.988968 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fact_reviews"
[0m00:01:08.989776 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-01 00:01:08.946198 => 2023-02-01 00:01:08.989640
[0m00:01:08.990662 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m00:01:08.992133 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-01 00:01:08.957006 => 2023-02-01 00:01:08.992026
[0m00:01:09.024765 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m00:01:09.043229 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (compile): 2023-02-01 00:01:08.969457 => 2023-02-01 00:01:09.043122
[0m00:01:09.049587 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fact_reviews
[0m00:01:09.086062 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m00:01:09.095235 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m00:01:09.120012 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m00:01:09.120393 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (With  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
        SELECT * FROM AIRBNB.RAW.RAW_HOSTS)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
),src_hosts as (
    select * from __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m00:01:09.120670 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:01:09.150754 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m00:01:09.156415 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (With  __dbt__cte__src_listings as (
WITH raw_listings AS(
        SELECT * FROM AIRBNB.RAW.RAW_LISTINGS)
SELECT 
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at
FROM
    raw_listings
),src_listings as (
    select * from __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    case
        when minimum_nights=0 then 1
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(
        price_str,
        '$'
    )::NUMBER(
        10,
        2
    ) as price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m00:01:09.158326 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:09.158926 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:01:09.160153 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
create or replace  temporary view airbnb.dev.fact_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
        SELECT * FROM AIRBNB.RAW.RAW_REVIEWS)
SELECT 
    listing_id,
    DATE as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM
    raw_reviews
),src_reviews as (
    select * from __dbt__cte__src_reviews
)
select * from src_reviews
where review_text is not null


    And review_date>(select max(review_date) from airbnb.dev.fact_reviews)

  );
[0m00:01:09.161448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:11.490081 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m00:01:11.526585 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-01 00:01:09.025138 => 2023-02-01 00:01:11.526509
[0m00:01:11.526961 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m00:01:11.586755 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m00:01:11.592392 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-01 00:01:08.992434 => 2023-02-01 00:01:11.592319
[0m00:01:11.592745 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m00:01:11.736248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m00:01:11.752518 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:11.753028 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m00:01:11.801430 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0166ef40>]}
[0m00:01:11.802248 [info ] [Thread-3  ]: 2 of 4 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.86s]
[0m00:01:11.803078 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m00:01:11.923493 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m00:01:11.932166 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a016252e0>]}
[0m00:01:11.933554 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:11.933914 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews
[0m00:01:11.935520 [info ] [Thread-2  ]: 1 of 4 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.99s]
[0m00:01:11.936301 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m00:01:11.938058 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m00:01:11.938703 [info ] [Thread-4  ]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m00:01:11.940515 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m00:01:11.941037 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m00:01:11.945653 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m00:01:11.948691 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-01 00:01:11.941405 => 2023-02-01 00:01:11.948569
[0m00:01:11.949107 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m00:01:11.952995 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m00:01:11.954652 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m00:01:11.954980 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH l AS ( SELECT * FROM airbnb.dev.dim_listings_cleansed ), 
h AS ( SELECT * FROM airbnb.dev.dim_hosts_cleansed )
SELECT l.listing_id, l.listing_name, l.room_type, l.minimum_nights, l.price, l.host_id, h.host_name, h.is_superhost as host_is_superhost, l.created_at, GREATEST(l.updated_at, h.updated_at) as updated_at FROM l LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m00:01:11.955346 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:01:12.107451 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m00:01:12.130170 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:12.130530 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table airbnb.dev.fact_reviews__dbt_tmp
[0m00:01:12.302548 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m00:01:12.309443 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:12.309802 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
describe table "AIRBNB"."DEV"."FACT_REVIEWS"
[0m00:01:12.478976 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m00:01:12.511643 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FACT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:01:12.562797 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fact_reviews"
[0m00:01:12.587555 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:12.597659 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:12.804623 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m00:01:12.805225 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:12.805581 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
insert into airbnb.dev.fact_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fact_reviews__dbt_tmp
        );
[0m00:01:13.336277 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1 seconds
[0m00:01:13.337111 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:13.337612 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
COMMIT
[0m00:01:13.641837 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m00:01:13.654266 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fact_reviews"
[0m00:01:13.654622 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fact_reviews"} */
drop view if exists airbnb.dev.fact_reviews__dbt_tmp cascade
[0m00:01:14.062386 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m00:01:14.067379 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fact_reviews (execute): 2023-02-01 00:01:09.055600 => 2023-02-01 00:01:14.067286
[0m00:01:14.067798 [debug] [Thread-1  ]: On model.dbtlearn.fact_reviews: Close
[0m00:01:14.462299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a01784ee0>]}
[0m00:01:14.463123 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model dev.fact_reviews ....................... [[32mSUCCESS 0[0m in 5.52s]
[0m00:01:14.463961 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fact_reviews
[0m00:01:17.321852 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5 seconds
[0m00:01:17.327380 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-01 00:01:11.949330 => 2023-02-01 00:01:17.327309
[0m00:01:17.327726 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m00:01:17.659394 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8de3c7d1-0b75-4639-82d4-4b44393b6bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a017821f0>]}
[0m00:01:17.660179 [info ] [Thread-4  ]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 5.72s]
[0m00:01:17.661447 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m00:01:17.664566 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:17.665408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:17.665812 [debug] [MainThread]: Connection 'model.dbtlearn.fact_reviews' was properly closed.
[0m00:01:17.666068 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m00:01:17.666288 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m00:01:17.666502 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m00:01:17.666811 [info ] [MainThread]: 
[0m00:01:17.667258 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 14.45 seconds (14.45s).
[0m00:01:17.668019 [debug] [MainThread]: Command end result
[0m00:01:17.678164 [info ] [MainThread]: 
[0m00:01:17.678937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:17.679505 [info ] [MainThread]: 
[0m00:01:17.679940 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:01:17.680413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0170c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0125a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0125a430>]}
[0m00:01:17.680799 [debug] [MainThread]: Flushing usage events
